INFO : 2022-08-08 00:14:20,425 : cdc_customer_landing_to_rawdb_csv : _config_provider.py.load_config: line(41) : Loading Dataflow configuration from file /Users/shaunryan/AzureDevOps/yetl-patterns/config/pipeline/local/config.yaml
INFO : 2022-08-08 00:14:20,428 : cdc_customer_landing_to_rawdb_csv : _context.py._get_spark_context: line(85) : Setting spark context
:: loading settings :: url = jar:file:/Users/shaunryan/opt/spark-3.2.1-bin-hadoop3.2/jars/ivy-2.5.0.jar!/org/apache/ivy/core/settings/ivysettings.xml
INFO : 2022-08-08 00:14:24,744 : cdc_customer_landing_to_rawdb_csv : _context.py.__init__: line(50) : Setting application context spark logger at level ERROR
INFO : 2022-08-08 00:14:24,747 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_file_system_type: line(50) : Setting filestystem using protocol file:
INFO : 2022-08-08 00:14:24,747 : cdc_customer_landing_to_rawdb_csv : _context.py.__init__: line(66) : Setting application context dataflow cdc_customer_landing_to_rawdb_csv
INFO : 2022-08-08 00:14:24,747 : cdc_customer_landing_to_rawdb_csv : _config_provider.py.load_pipeline_config: line(29) : Loading Dataflow configuration from file /Users/shaunryan/AzureDevOps/yetl-patterns/config/pipeline/local/cdc_customer_landing_to_rawdb_csv.yaml
INFO : 2022-08-08 00:14:24,759 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on spark_schema_file 
INFO : 2022-08-08 00:14:24,760 : cdc_customer_landing_to_rawdb_csv : _spark_file_schema_repo.py.load_schema: line(50) : Loading schema for dataset landing.cdc_customer from /Users/shaunryan/AzureDevOps/yetl-patterns/config/schema/spark/landing/cdc_customer.yaml using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:14:24,765 : cdc_customer_landing_to_rawdb_csv : _reader.py.__init__: line(49) : auto_io = True automatically creating or altering exception delta table landing.cdc_customer _correlation_id=465e796a-682b-48e5-9fb2-5f2976595efd
INFO : 2022-08-08 00:14:24,765 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `landing`
INFO : 2022-08-08 00:14:31,673 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_table: line(16) : Creating table if not exists landing.exceptions at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/exceptions/landing/exceptions
INFO : 2022-08-08 00:14:38,729 : cdc_customer_landing_to_rawdb_csv : _reader.py.read: line(195) : Reading data for landing.cdc_customer from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv with options {'mode': 'PERMISSIVE', 'inferSchema': False, 'header': True, 'timestampFormat': 'yyyy-MM-dd HH:mm:ss'} _correlation_id=465e796a-682b-48e5-9fb2-5f2976595efd
INFO : 2022-08-08 00:14:38,890 : cdc_customer_landing_to_rawdb_csv : _reader.py.validate: line(181) : Validating dataframe read using PERMISSIVE corrupt column at _corrupt_record _correlation_id=465e796a-682b-48e5-9fb2-5f2976595efd
INFO : 2022-08-08 00:14:39,477 : cdc_customer_landing_to_rawdb_csv : _reader.py.validate: line(192) : {
    "validation": {
        "schema_on_read": {
            "landing.cdc_customer": {
                "total_count": 10,
                "valid_count": 10,
                "exception_count": 0
            }
        }
    }
}
INFO : 2022-08-08 00:14:39,477 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on deltalake_sql_file 
INFO : 2022-08-08 00:14:39,477 : cdc_customer_landing_to_rawdb_csv : _deltalake_sql_file.py.load_schema: line(43) : Loading schema for dataset raw.cdc_customer from ./config/schema/deltalake/raw/cdc_customer.sql using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:14:39,478 : cdc_customer_landing_to_rawdb_csv : _writer.py.__init__: line(40) : auto_io = True automatically creating or altering delta table raw.cdc_customer
INFO : 2022-08-08 00:14:39,478 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `raw`
INFO : 2022-08-08 00:14:39,571 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_table: line(16) : Creating table if not exists raw.cdc_customer at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer
INFO : 2022-08-08 00:14:50,175 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on deltalake_sql_file 
INFO : 2022-08-08 00:14:50,175 : cdc_customer_landing_to_rawdb_csv : _deltalake_sql_file.py.load_schema: line(43) : Loading schema for dataset raw.cdc_customer_history from ./config/schema/deltalake/raw/cdc_customer_history.sql using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:14:50,175 : cdc_customer_landing_to_rawdb_csv : _writer.py.__init__: line(40) : auto_io = True automatically creating or altering delta table raw.cdc_customer_history
INFO : 2022-08-08 00:14:50,175 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `raw`
INFO : 2022-08-08 00:14:50,244 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_table: line(16) : Creating table if not exists raw.cdc_customer_history at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer_history
INFO : 2022-08-08 00:14:58,705 : cdc_customer_landing_to_rawdb_csv : _framework.py.wrap_function: line(36) : Executing Dataflow cdc_customer_landing_to_rawdb_csv with:
                timeslice=2022-08-01 00:00:00.000000 
                retries=1 
                save_type=DefaultSave
INFO : 2022-08-08 00:14:58,769 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(34) : Fetched dst delta table raw.cdc_customer from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer
INFO : 2022-08-08 00:14:58,776 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(41) : Fetched dst delta table raw.cdc_customer_history from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer_history
INFO : 2022-08-08 00:14:59,095 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(95) : Change set
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+---------+-------+------------+--------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |data_name|next_id|next_version|next_from_date|
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+---------+-------+------------+--------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male      |Junior Executive       |36.18 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|4  |2008-01-01 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|5  |2008-01-01 00:00:00|I        |Sara      |Whiterod       |swhiterod4@hhs.gov           |Female    |Assistant Manager      |47.85 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|6  |2008-01-01 00:00:00|I        |Mariska   |Antrum         |mantrum5@nytimes.com         |Female    |Tax Accountant         |16.37 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|7  |2008-01-01 00:00:00|I        |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|9  |2008-01-01 00:00:00|I        |Chaunce   |Holdforth      |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|10 |2008-01-01 00:00:00|I        |Blinni    |Fenty          |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+---------+-------+------------+--------------+

INFO : 2022-08-08 00:15:02,477 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(104) : Change Set for Delete
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male      |Junior Executive       |36.18 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|4  |2008-01-01 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|5  |2008-01-01 00:00:00|I        |Sara      |Whiterod       |swhiterod4@hhs.gov           |Female    |Assistant Manager      |47.85 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|6  |2008-01-01 00:00:00|I        |Mariska   |Antrum         |mantrum5@nytimes.com         |Female    |Tax Accountant         |16.37 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|7  |2008-01-01 00:00:00|I        |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|9  |2008-01-01 00:00:00|I        |Chaunce   |Holdforth      |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|10 |2008-01-01 00:00:00|I        |Blinni    |Fenty          |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

+---+------------+---------+----------+---------+-----+------+---------+------+---------+-------+-------+------+---------------+---------------+---------+
|id |extract_date|load_flag|first_name|last_name|email|gender|job_title|amount|from_date|to_date|version|active|_correlation_id|_load_timestamp|_filename|
+---+------------+---------+----------+---------+-----+------+---------+------+---------+-------+-------+------+---------------+---------------+---------+
+---+------------+---------+----------+---------+-----+------+---------+------+---------+-------+-------+------+---------------+---------------+---------+

INFO : 2022-08-08 00:15:13,091 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(132) : History
+------------+---------+---+----------+---------+-----+------+---------+------+---------+-------+-------+------+---------------+---------------+---------+
|extract_date|load_flag|id |first_name|last_name|email|gender|job_title|amount|from_date|to_date|version|active|_correlation_id|_load_timestamp|_filename|
+------------+---------+---+----------+---------+-----+------+---------+------+---------+-------+-------+------+---------------+---------------+---------+
+------------+---------+---+----------+---------+-----+------+---------+------+---------+-------+-------+------+---------------+---------------+---------+

INFO : 2022-08-08 00:15:13,423 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(137) : Change Set for Current
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male      |Junior Executive       |36.18 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|4  |2008-01-01 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|5  |2008-01-01 00:00:00|I        |Sara      |Whiterod       |swhiterod4@hhs.gov           |Female    |Assistant Manager      |47.85 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|6  |2008-01-01 00:00:00|I        |Mariska   |Antrum         |mantrum5@nytimes.com         |Female    |Tax Accountant         |16.37 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|7  |2008-01-01 00:00:00|I        |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|9  |2008-01-01 00:00:00|I        |Chaunce   |Holdforth      |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|10 |2008-01-01 00:00:00|I        |Blinni    |Fenty          |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male      |Junior Executive       |36.18 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|4  |2008-01-01 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|5  |2008-01-01 00:00:00|I        |Sara      |Whiterod       |swhiterod4@hhs.gov           |Female    |Assistant Manager      |47.85 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|6  |2008-01-01 00:00:00|I        |Mariska   |Antrum         |mantrum5@nytimes.com         |Female    |Tax Accountant         |16.37 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|7  |2008-01-01 00:00:00|I        |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|9  |2008-01-01 00:00:00|I        |Chaunce   |Holdforth      |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|10 |2008-01-01 00:00:00|I        |Blinni    |Fenty          |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:15:33,157 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(154) : Current
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|extract_date       |load_flag|id |first_name|last_name      |email                        |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|2008-01-01 00:00:00|I        |1  |Davidde   |Legier         |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |2  |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male      |Junior Executive       |36.18 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |3  |Chic      |Ickowics       |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |4  |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |5  |Sara      |Whiterod       |swhiterod4@hhs.gov           |Female    |Assistant Manager      |47.85 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |6  |Mariska   |Antrum         |mantrum5@nytimes.com         |Female    |Tax Accountant         |16.37 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |7  |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |8  |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |9  |Chaunce   |Holdforth      |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |10 |Blinni    |Fenty          |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:15:33,589 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audit: line(34) : Auditing database table raw.cdc_customer
INFO : 2022-08-08 00:15:34,057 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audit: line(34) : Auditing database table raw.cdc_customer_history
INFO : 2022-08-08 00:15:34,269 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audits: line(48) : {
    "raw.cdc_customer": {
        "clusterId": null,
        "engineInfo": "Apache-Spark/3.2.1 Delta-Lake/2.0.0",
        "isBlindAppend": false,
        "isolationLevel": "Serializable",
        "job": null,
        "notebook": null,
        "operation": "MERGE",
        "operationMetrics": {
            "executionTimeMs": "13797",
            "numOutputRows": "10",
            "numSourceRows": "10",
            "numTargetChangeFilesAdded": "10",
            "numTargetFilesAdded": "10",
            "numTargetFilesRemoved": "0",
            "numTargetRowsCopied": "0",
            "numTargetRowsDeleted": "0",
            "numTargetRowsInserted": "10",
            "numTargetRowsUpdated": "0",
            "rewriteTimeMs": "12246",
            "scanTimeMs": "1550"
        },
        "operationParameters": {
            "matchedPredicates": "[{\"predicate\":\"((src.load_flag IN ('I', 'U')) AND (NOT (src.extract_date = dst.extract_date)))\",\"actionType\":\"update\"},{\"predicate\":\"(src.load_flag = 'D')\",\"actionType\":\"delete\"}]",
            "notMatchedPredicates": "[{\"predicate\":\"(src.load_flag IN ('I', 'U'))\",\"actionType\":\"insert\"}]",
            "predicate": "(dst.id = src.id)"
        },
        "readVersion": 3,
        "timestamp": "2022-08-08 00:15:30.349000",
        "userId": null,
        "userMetadata": null,
        "userName": null,
        "version": 4
    },
    "raw.cdc_customer_history": {
        "clusterId": null,
        "engineInfo": "Apache-Spark/3.2.1 Delta-Lake/2.0.0",
        "isBlindAppend": false,
        "isolationLevel": "SnapshotIsolation",
        "job": null,
        "notebook": null,
        "operation": "MERGE",
        "operationMetrics": {
            "executionTimeMs": "3488",
            "numOutputRows": "0",
            "numSourceRows": "0",
            "numTargetChangeFilesAdded": "0",
            "numTargetFilesAdded": "0",
            "numTargetFilesRemoved": "0",
            "numTargetRowsCopied": "0",
            "numTargetRowsDeleted": "0",
            "numTargetRowsInserted": "0",
            "numTargetRowsUpdated": "0",
            "rewriteTimeMs": "1677",
            "scanTimeMs": "1807"
        },
        "operationParameters": {
            "matchedPredicates": "[{\"predicate\":\"(((NOT (dst.from_date = src.from_date)) OR (NOT (dst.to_date = src.to_date))) OR ((NOT (dst.version = src.version)) OR (NOT (dst.active = src.active))))\",\"actionType\":\"update\"}]",
            "notMatchedPredicates": "[{\"actionType\":\"insert\"}]",
            "predicate": "((dst.id = src.id) AND (dst.extract_date = src.extract_date))"
        },
        "readVersion": 3,
        "timestamp": "2022-08-08 00:15:10.220000",
        "userId": null,
        "userMetadata": null,
        "userName": null,
        "version": 4
    }
}
INFO : 2022-08-08 00:15:34,269 : cdc_customer_landing_to_rawdb_csv : _config_provider.py.load_config: line(41) : Loading Dataflow configuration from file /Users/shaunryan/AzureDevOps/yetl-patterns/config/pipeline/local/config.yaml
INFO : 2022-08-08 00:15:34,271 : cdc_customer_landing_to_rawdb_csv : _context.py._get_spark_context: line(85) : Setting spark context
INFO : 2022-08-08 00:15:34,299 : cdc_customer_landing_to_rawdb_csv : _context.py.__init__: line(50) : Setting application context spark logger at level ERROR
INFO : 2022-08-08 00:15:34,301 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_file_system_type: line(50) : Setting filestystem using protocol file:
INFO : 2022-08-08 00:15:34,301 : cdc_customer_landing_to_rawdb_csv : _context.py.__init__: line(66) : Setting application context dataflow cdc_customer_landing_to_rawdb_csv
INFO : 2022-08-08 00:15:34,302 : cdc_customer_landing_to_rawdb_csv : _config_provider.py.load_pipeline_config: line(29) : Loading Dataflow configuration from file /Users/shaunryan/AzureDevOps/yetl-patterns/config/pipeline/local/cdc_customer_landing_to_rawdb_csv.yaml
INFO : 2022-08-08 00:15:34,314 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on spark_schema_file 
INFO : 2022-08-08 00:15:34,314 : cdc_customer_landing_to_rawdb_csv : _spark_file_schema_repo.py.load_schema: line(50) : Loading schema for dataset landing.cdc_customer from /Users/shaunryan/AzureDevOps/yetl-patterns/config/schema/spark/landing/cdc_customer.yaml using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:15:34,319 : cdc_customer_landing_to_rawdb_csv : _reader.py.__init__: line(49) : auto_io = True automatically creating or altering exception delta table landing.cdc_customer _correlation_id=78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c
INFO : 2022-08-08 00:15:34,319 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `landing`
INFO : 2022-08-08 00:15:34,373 : cdc_customer_landing_to_rawdb_csv : _reader.py.create_or_alter_table: line(61) : Exception table already exists landing.exceptions at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/exceptions/landing/exceptions _correlation_id=78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c
INFO : 2022-08-08 00:15:34,373 : cdc_customer_landing_to_rawdb_csv : _reader.py.read: line(195) : Reading data for landing.cdc_customer from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv with options {'mode': 'PERMISSIVE', 'inferSchema': False, 'header': True, 'timestampFormat': 'yyyy-MM-dd HH:mm:ss'} _correlation_id=78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c
INFO : 2022-08-08 00:15:34,396 : cdc_customer_landing_to_rawdb_csv : _reader.py.validate: line(181) : Validating dataframe read using PERMISSIVE corrupt column at _corrupt_record _correlation_id=78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c
INFO : 2022-08-08 00:15:34,663 : cdc_customer_landing_to_rawdb_csv : _reader.py.validate: line(192) : {
    "validation": {
        "schema_on_read": {
            "landing.cdc_customer": {
                "total_count": 10,
                "valid_count": 10,
                "exception_count": 0
            }
        }
    }
}
INFO : 2022-08-08 00:15:34,663 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on deltalake_sql_file 
INFO : 2022-08-08 00:15:34,663 : cdc_customer_landing_to_rawdb_csv : _deltalake_sql_file.py.load_schema: line(43) : Loading schema for dataset raw.cdc_customer from ./config/schema/deltalake/raw/cdc_customer.sql using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:15:34,663 : cdc_customer_landing_to_rawdb_csv : _writer.py.__init__: line(40) : auto_io = True automatically creating or altering delta table raw.cdc_customer
INFO : 2022-08-08 00:15:34,663 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `raw`
INFO : 2022-08-08 00:15:34,712 : cdc_customer_landing_to_rawdb_csv : _writer.py.create_or_alter_table: line(88) : Table already exists raw.cdc_customer at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer
INFO : 2022-08-08 00:15:34,712 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(69) : getting existing table properties for table raw.cdc_customer
INFO : 2022-08-08 00:15:34,762 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(91) : {
    "raw.cdc_customer": {
        "constraints": {
            "amount_lower_bound": "amount > - 1000",
            "amount_upper_bound": "amount < 1000000"
        },
        "properties": {
            "Type": "EXTERNAL",
            "delta.appendOnly": "False",
            "delta.checkpoint.writeStatsAsJson": "True",
            "delta.compatibility.symlinkFormatManifest.enabled": "False",
            "delta.dataSkippingNumIndexedCols": "-1",
            "delta.deletedFileRetentionDuration": "interval 1 week",
            "delta.enableChangeDataFeed": "True",
            "delta.logRetentionDuration": "interval 30 days",
            "delta.minReaderVersion": "1",
            "delta.minWriterVersion": "4",
            "delta.randomPrefixLength": "2",
            "delta.randomizeFilePrefixes": "False",
            "external": "true"
        }
    }
}
INFO : 2022-08-08 00:15:39,989 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on deltalake_sql_file 
INFO : 2022-08-08 00:15:39,989 : cdc_customer_landing_to_rawdb_csv : _deltalake_sql_file.py.load_schema: line(43) : Loading schema for dataset raw.cdc_customer_history from ./config/schema/deltalake/raw/cdc_customer_history.sql using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:15:39,989 : cdc_customer_landing_to_rawdb_csv : _writer.py.__init__: line(40) : auto_io = True automatically creating or altering delta table raw.cdc_customer_history
INFO : 2022-08-08 00:15:39,989 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `raw`
INFO : 2022-08-08 00:15:40,026 : cdc_customer_landing_to_rawdb_csv : _writer.py.create_or_alter_table: line(88) : Table already exists raw.cdc_customer_history at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer_history
INFO : 2022-08-08 00:15:40,026 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(69) : getting existing table properties for table raw.cdc_customer_history
INFO : 2022-08-08 00:15:40,052 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(91) : {
    "raw.cdc_customer_history": {
        "constraints": {
            "amount_lower_bound": "amount > - 1000",
            "amount_upper_bound": "amount < 1000000"
        },
        "properties": {
            "Type": "EXTERNAL",
            "delta.appendOnly": "False",
            "delta.checkpoint.writeStatsAsJson": "True",
            "delta.compatibility.symlinkFormatManifest.enabled": "False",
            "delta.dataSkippingNumIndexedCols": "-1",
            "delta.deletedFileRetentionDuration": "interval 1 week",
            "delta.enableChangeDataFeed": "True",
            "delta.logRetentionDuration": "interval 30 days",
            "delta.minReaderVersion": "1",
            "delta.minWriterVersion": "4",
            "delta.randomPrefixLength": "2",
            "delta.randomizeFilePrefixes": "False",
            "external": "true"
        }
    }
}
INFO : 2022-08-08 00:15:45,066 : cdc_customer_landing_to_rawdb_csv : _framework.py.wrap_function: line(36) : Executing Dataflow cdc_customer_landing_to_rawdb_csv with:
                timeslice=2022-08-01 00:00:00.000000 
                retries=1 
                save_type=DefaultSave
INFO : 2022-08-08 00:15:45,097 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(34) : Fetched dst delta table raw.cdc_customer from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer
INFO : 2022-08-08 00:15:45,106 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(41) : Fetched dst delta table raw.cdc_customer_history from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer_history
INFO : 2022-08-08 00:15:45,264 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(95) : Change set
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+---------+-------+------------+--------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |data_name|next_id|next_version|next_from_date|
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+---------+-------+------------+--------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male      |Junior Executive       |36.18 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|4  |2008-01-01 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|5  |2008-01-01 00:00:00|I        |Sara      |Whiterod       |swhiterod4@hhs.gov           |Female    |Assistant Manager      |47.85 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|6  |2008-01-01 00:00:00|I        |Mariska   |Antrum         |mantrum5@nytimes.com         |Female    |Tax Accountant         |16.37 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|7  |2008-01-01 00:00:00|I        |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|9  |2008-01-01 00:00:00|I        |Chaunce   |Holdforth      |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
|10 |2008-01-01 00:00:00|I        |Blinni    |Fenty          |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|src      |null   |null        |null          |
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+---------+-------+------------+--------------+

INFO : 2022-08-08 00:15:47,866 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(104) : Change Set for Delete
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male      |Junior Executive       |36.18 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|4  |2008-01-01 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|5  |2008-01-01 00:00:00|I        |Sara      |Whiterod       |swhiterod4@hhs.gov           |Female    |Assistant Manager      |47.85 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|6  |2008-01-01 00:00:00|I        |Mariska   |Antrum         |mantrum5@nytimes.com         |Female    |Tax Accountant         |16.37 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|7  |2008-01-01 00:00:00|I        |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|9  |2008-01-01 00:00:00|I        |Chaunce   |Holdforth      |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|10 |2008-01-01 00:00:00|I        |Blinni    |Fenty          |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

+---+------------+---------+----------+---------+-----+------+---------+------+---------+-------+-------+------+---------------+---------------+---------+
|id |extract_date|load_flag|first_name|last_name|email|gender|job_title|amount|from_date|to_date|version|active|_correlation_id|_load_timestamp|_filename|
+---+------------+---------+----------+---------+-----+------+---------+------+---------+-------+-------+------+---------------+---------------+---------+
+---+------------+---------+----------+---------+-----+------+---------+------+---------+-------+-------+------+---------------+---------------+---------+

INFO : 2022-08-08 00:15:57,774 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(132) : History
+------------+---------+---+----------+---------+-----+------+---------+------+---------+-------+-------+------+---------------+---------------+---------+
|extract_date|load_flag|id |first_name|last_name|email|gender|job_title|amount|from_date|to_date|version|active|_correlation_id|_load_timestamp|_filename|
+------------+---------+---+----------+---------+-----+------+---------+------+---------+-------+-------+------+---------------+---------------+---------+
+------------+---------+---+----------+---------+-----+------+---------+------+---------+-------+-------+------+---------------+---------------+---------+

INFO : 2022-08-08 00:15:58,070 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(137) : Change Set for Current
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male      |Junior Executive       |36.18 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|4  |2008-01-01 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|5  |2008-01-01 00:00:00|I        |Sara      |Whiterod       |swhiterod4@hhs.gov           |Female    |Assistant Manager      |47.85 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|6  |2008-01-01 00:00:00|I        |Mariska   |Antrum         |mantrum5@nytimes.com         |Female    |Tax Accountant         |16.37 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|7  |2008-01-01 00:00:00|I        |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|9  |2008-01-01 00:00:00|I        |Chaunce   |Holdforth      |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|10 |2008-01-01 00:00:00|I        |Blinni    |Fenty          |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male      |Junior Executive       |36.18 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|4  |2008-01-01 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|5  |2008-01-01 00:00:00|I        |Sara      |Whiterod       |swhiterod4@hhs.gov           |Female    |Assistant Manager      |47.85 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|6  |2008-01-01 00:00:00|I        |Mariska   |Antrum         |mantrum5@nytimes.com         |Female    |Tax Accountant         |16.37 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|7  |2008-01-01 00:00:00|I        |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|9  |2008-01-01 00:00:00|I        |Chaunce   |Holdforth      |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|10 |2008-01-01 00:00:00|I        |Blinni    |Fenty          |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98 |2008-01-01|9999-12-31|1      |true  |78fa1bcd-d21e-4c62-b4aa-c5b6b19aeb5c|2022-08-08 00:15:34.456621|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:16:17,914 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(154) : Current
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|extract_date       |load_flag|id |first_name|last_name      |email                        |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|2008-01-01 00:00:00|I        |1  |Davidde   |Legier         |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |2  |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male      |Junior Executive       |36.18 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |3  |Chic      |Ickowics       |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |4  |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |5  |Sara      |Whiterod       |swhiterod4@hhs.gov           |Female    |Assistant Manager      |47.85 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |6  |Mariska   |Antrum         |mantrum5@nytimes.com         |Female    |Tax Accountant         |16.37 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |7  |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |8  |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |9  |Chaunce   |Holdforth      |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |10 |Blinni    |Fenty          |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:16:18,271 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audit: line(34) : Auditing database table raw.cdc_customer
INFO : 2022-08-08 00:16:18,541 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audit: line(34) : Auditing database table raw.cdc_customer_history
INFO : 2022-08-08 00:16:18,740 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audits: line(48) : {
    "raw.cdc_customer": {
        "clusterId": null,
        "engineInfo": "Apache-Spark/3.2.1 Delta-Lake/2.0.0",
        "isBlindAppend": false,
        "isolationLevel": "Serializable",
        "job": null,
        "notebook": null,
        "operation": "MERGE",
        "operationMetrics": {
            "executionTimeMs": "12997",
            "numOutputRows": "10",
            "numSourceRows": "10",
            "numTargetChangeFilesAdded": "0",
            "numTargetFilesAdded": "10",
            "numTargetFilesRemoved": "10",
            "numTargetRowsCopied": "10",
            "numTargetRowsDeleted": "0",
            "numTargetRowsInserted": "0",
            "numTargetRowsUpdated": "0",
            "rewriteTimeMs": "11658",
            "scanTimeMs": "1337"
        },
        "operationParameters": {
            "matchedPredicates": "[{\"predicate\":\"((src.load_flag IN ('I', 'U')) AND (NOT (src.extract_date = dst.extract_date)))\",\"actionType\":\"update\"},{\"predicate\":\"(src.load_flag = 'D')\",\"actionType\":\"delete\"}]",
            "notMatchedPredicates": "[{\"predicate\":\"(src.load_flag IN ('I', 'U'))\",\"actionType\":\"insert\"}]",
            "predicate": "(dst.id = src.id)"
        },
        "readVersion": 7,
        "timestamp": "2022-08-08 00:16:14.119000",
        "userId": null,
        "userMetadata": null,
        "userName": null,
        "version": 8
    },
    "raw.cdc_customer_history": {
        "clusterId": null,
        "engineInfo": "Apache-Spark/3.2.1 Delta-Lake/2.0.0",
        "isBlindAppend": false,
        "isolationLevel": "SnapshotIsolation",
        "job": null,
        "notebook": null,
        "operation": "MERGE",
        "operationMetrics": {
            "executionTimeMs": "3041",
            "numOutputRows": "0",
            "numSourceRows": "0",
            "numTargetChangeFilesAdded": "0",
            "numTargetFilesAdded": "0",
            "numTargetFilesRemoved": "0",
            "numTargetRowsCopied": "0",
            "numTargetRowsDeleted": "0",
            "numTargetRowsInserted": "0",
            "numTargetRowsUpdated": "0",
            "rewriteTimeMs": "1338",
            "scanTimeMs": "1700"
        },
        "operationParameters": {
            "matchedPredicates": "[{\"predicate\":\"(((NOT (dst.from_date = src.from_date)) OR (NOT (dst.to_date = src.to_date))) OR ((NOT (dst.version = src.version)) OR (NOT (dst.active = src.active))))\",\"actionType\":\"update\"}]",
            "notMatchedPredicates": "[{\"actionType\":\"insert\"}]",
            "predicate": "((dst.id = src.id) AND (dst.extract_date = src.extract_date))"
        },
        "readVersion": 7,
        "timestamp": "2022-08-08 00:15:54.041000",
        "userId": null,
        "userMetadata": null,
        "userName": null,
        "version": 8
    }
}
INFO : 2022-08-08 00:16:18,741 : cdc_customer_landing_to_rawdb_csv : _config_provider.py.load_config: line(41) : Loading Dataflow configuration from file /Users/shaunryan/AzureDevOps/yetl-patterns/config/pipeline/local/config.yaml
INFO : 2022-08-08 00:16:18,743 : cdc_customer_landing_to_rawdb_csv : _context.py._get_spark_context: line(85) : Setting spark context
INFO : 2022-08-08 00:16:18,746 : cdc_customer_landing_to_rawdb_csv : _context.py.__init__: line(50) : Setting application context spark logger at level ERROR
INFO : 2022-08-08 00:16:18,749 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_file_system_type: line(50) : Setting filestystem using protocol file:
INFO : 2022-08-08 00:16:18,749 : cdc_customer_landing_to_rawdb_csv : _context.py.__init__: line(66) : Setting application context dataflow cdc_customer_landing_to_rawdb_csv
INFO : 2022-08-08 00:16:18,749 : cdc_customer_landing_to_rawdb_csv : _config_provider.py.load_pipeline_config: line(29) : Loading Dataflow configuration from file /Users/shaunryan/AzureDevOps/yetl-patterns/config/pipeline/local/cdc_customer_landing_to_rawdb_csv.yaml
INFO : 2022-08-08 00:16:18,760 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on spark_schema_file 
INFO : 2022-08-08 00:16:18,761 : cdc_customer_landing_to_rawdb_csv : _spark_file_schema_repo.py.load_schema: line(50) : Loading schema for dataset landing.cdc_customer from /Users/shaunryan/AzureDevOps/yetl-patterns/config/schema/spark/landing/cdc_customer.yaml using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:16:18,766 : cdc_customer_landing_to_rawdb_csv : _reader.py.__init__: line(49) : auto_io = True automatically creating or altering exception delta table landing.cdc_customer _correlation_id=f228bf9e-21c3-403f-90aa-23a195b33481
INFO : 2022-08-08 00:16:18,766 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `landing`
INFO : 2022-08-08 00:16:18,811 : cdc_customer_landing_to_rawdb_csv : _reader.py.create_or_alter_table: line(61) : Exception table already exists landing.exceptions at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/exceptions/landing/exceptions _correlation_id=f228bf9e-21c3-403f-90aa-23a195b33481
INFO : 2022-08-08 00:16:18,812 : cdc_customer_landing_to_rawdb_csv : _reader.py.read: line(195) : Reading data for landing.cdc_customer from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv with options {'mode': 'PERMISSIVE', 'inferSchema': False, 'header': True, 'timestampFormat': 'yyyy-MM-dd HH:mm:ss'} _correlation_id=f228bf9e-21c3-403f-90aa-23a195b33481
INFO : 2022-08-08 00:16:18,831 : cdc_customer_landing_to_rawdb_csv : _reader.py.validate: line(181) : Validating dataframe read using PERMISSIVE corrupt column at _corrupt_record _correlation_id=f228bf9e-21c3-403f-90aa-23a195b33481
INFO : 2022-08-08 00:16:19,023 : cdc_customer_landing_to_rawdb_csv : _reader.py.validate: line(192) : {
    "validation": {
        "schema_on_read": {
            "landing.cdc_customer": {
                "total_count": 7,
                "valid_count": 7,
                "exception_count": 0
            }
        }
    }
}
INFO : 2022-08-08 00:16:19,023 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on deltalake_sql_file 
INFO : 2022-08-08 00:16:19,023 : cdc_customer_landing_to_rawdb_csv : _deltalake_sql_file.py.load_schema: line(43) : Loading schema for dataset raw.cdc_customer from ./config/schema/deltalake/raw/cdc_customer.sql using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:16:19,024 : cdc_customer_landing_to_rawdb_csv : _writer.py.__init__: line(40) : auto_io = True automatically creating or altering delta table raw.cdc_customer
INFO : 2022-08-08 00:16:19,024 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `raw`
INFO : 2022-08-08 00:16:19,062 : cdc_customer_landing_to_rawdb_csv : _writer.py.create_or_alter_table: line(88) : Table already exists raw.cdc_customer at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer
INFO : 2022-08-08 00:16:19,062 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(69) : getting existing table properties for table raw.cdc_customer
INFO : 2022-08-08 00:16:19,094 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(91) : {
    "raw.cdc_customer": {
        "constraints": {
            "amount_lower_bound": "amount > - 1000",
            "amount_upper_bound": "amount < 1000000"
        },
        "properties": {
            "Type": "EXTERNAL",
            "delta.appendOnly": "False",
            "delta.checkpoint.writeStatsAsJson": "True",
            "delta.compatibility.symlinkFormatManifest.enabled": "False",
            "delta.dataSkippingNumIndexedCols": "-1",
            "delta.deletedFileRetentionDuration": "interval 1 week",
            "delta.enableChangeDataFeed": "True",
            "delta.logRetentionDuration": "interval 30 days",
            "delta.minReaderVersion": "1",
            "delta.minWriterVersion": "4",
            "delta.randomPrefixLength": "2",
            "delta.randomizeFilePrefixes": "False",
            "external": "true"
        }
    }
}
INFO : 2022-08-08 00:16:24,883 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on deltalake_sql_file 
INFO : 2022-08-08 00:16:24,883 : cdc_customer_landing_to_rawdb_csv : _deltalake_sql_file.py.load_schema: line(43) : Loading schema for dataset raw.cdc_customer_history from ./config/schema/deltalake/raw/cdc_customer_history.sql using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:16:24,883 : cdc_customer_landing_to_rawdb_csv : _writer.py.__init__: line(40) : auto_io = True automatically creating or altering delta table raw.cdc_customer_history
INFO : 2022-08-08 00:16:24,883 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `raw`
INFO : 2022-08-08 00:16:24,918 : cdc_customer_landing_to_rawdb_csv : _writer.py.create_or_alter_table: line(88) : Table already exists raw.cdc_customer_history at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer_history
INFO : 2022-08-08 00:16:24,919 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(69) : getting existing table properties for table raw.cdc_customer_history
INFO : 2022-08-08 00:16:24,940 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(91) : {
    "raw.cdc_customer_history": {
        "constraints": {
            "amount_lower_bound": "amount > - 1000",
            "amount_upper_bound": "amount < 1000000"
        },
        "properties": {
            "Type": "EXTERNAL",
            "delta.appendOnly": "False",
            "delta.checkpoint.writeStatsAsJson": "True",
            "delta.compatibility.symlinkFormatManifest.enabled": "False",
            "delta.dataSkippingNumIndexedCols": "-1",
            "delta.deletedFileRetentionDuration": "interval 1 week",
            "delta.enableChangeDataFeed": "True",
            "delta.logRetentionDuration": "interval 30 days",
            "delta.minReaderVersion": "1",
            "delta.minWriterVersion": "4",
            "delta.randomPrefixLength": "2",
            "delta.randomizeFilePrefixes": "False",
            "external": "true"
        }
    }
}
INFO : 2022-08-08 00:16:30,335 : cdc_customer_landing_to_rawdb_csv : _framework.py.wrap_function: line(36) : Executing Dataflow cdc_customer_landing_to_rawdb_csv with:
                timeslice=2022-08-02 00:00:00.000000 
                retries=1 
                save_type=DefaultSave
INFO : 2022-08-08 00:16:30,365 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(34) : Fetched dst delta table raw.cdc_customer from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer
INFO : 2022-08-08 00:16:30,372 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(41) : Fetched dst delta table raw.cdc_customer_history from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer_history
INFO : 2022-08-08 00:16:30,515 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(95) : Change set
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+-----------+-------+------------+--------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender |job_title           |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |data_name  |next_id|next_version|next_from_date|
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+-----------+-------+------------+--------------+
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Super Hero          |86.5  |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|src        |null   |null        |null          |
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|dst_current|1      |2           |2008-01-01    |
|2  |2008-01-02 00:00:00|U        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Female |Senior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|src        |null   |null        |null          |
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|dst_current|2      |2           |2008-01-01    |
|3  |2008-01-02 00:00:00|D        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|src        |null   |null        |null          |
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|dst_current|3      |2           |2008-01-01    |
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|src        |null   |null        |null          |
|12 |2008-01-02 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|src        |null   |null        |null          |
|13 |2008-01-02 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|src        |null   |null        |null          |
|14 |2008-01-02 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV|73.21 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|src        |null   |null        |null          |
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+-----------+-------+------------+--------------+

INFO : 2022-08-08 00:16:33,018 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(104) : Change Set for Delete
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender |job_title           |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Super Hero          |86.5  |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2  |2008-01-02 00:00:00|U        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Female |Senior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-02 00:00:00|D        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|12 |2008-01-02 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|13 |2008-01-02 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|14 |2008-01-02 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV|73.21 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

+---+-------------------+---------+----------+---------+-------------------------+-------+------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name|email                    |gender |job_title         |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------+-------------------------+-------+------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier   |dlegier0@mail.ru         |Agender|Editor            |86.5  |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman  |pscirman1@kickstarter.com|Male   |Junior Executive  |36.18 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-02 00:00:00|D        |Chic      |Ickowics |cickowics2@booking.com   |Male   |Research Associate|35.54 |2008-01-02|9999-12-31|1      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics |cickowics2@booking.com   |Male   |Research Associate|35.54 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
+---+-------------------+---------+----------+---------+-------------------------+-------+------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:16:44,068 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(132) : History
+-------------------+---------+---+----------+---------+-------------------------+-------+------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|extract_date       |load_flag|id |first_name|last_name|email                    |gender |job_title         |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+-------------------+---------+---+----------+---------+-------------------------+-------+------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|2008-01-01 00:00:00|I        |1  |Davidde   |Legier   |dlegier0@mail.ru         |Agender|Editor            |86.5  |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |2  |Panchito  |Scirman  |pscirman1@kickstarter.com|Male   |Junior Executive  |36.18 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |3  |Chic      |Ickowics |cickowics2@booking.com   |Male   |Research Associate|35.54 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-02 00:00:00|D        |3  |Chic      |Ickowics |cickowics2@booking.com   |Male   |Research Associate|35.54 |2008-01-02|9999-12-31|1      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
+-------------------+---------+---+----------+---------+-------------------------+-------+------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:16:44,388 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(137) : Change Set for Current
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender |job_title           |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-01|2007-12-31|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Super Hero          |86.5  |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2  |2008-01-02 00:00:00|U        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Female |Senior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-01|2007-12-31|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-02 00:00:00|D        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-01|2007-12-31|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|12 |2008-01-02 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|13 |2008-01-02 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|14 |2008-01-02 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV|73.21 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender |job_title           |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Super Hero          |86.5  |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2  |2008-01-02 00:00:00|U        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Female |Senior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|3  |2008-01-02 00:00:00|D        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|12 |2008-01-02 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|13 |2008-01-02 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|14 |2008-01-02 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV|73.21 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:17:05,024 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(154) : Current
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|extract_date       |load_flag|id |first_name|last_name      |email                        |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|2008-01-02 00:00:00|U        |1  |Davidde   |Legier         |dlegier0@mail.ru             |Agender   |Super Hero             |86.5  |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-02 00:00:00|U        |2  |Panchito  |Scirman        |pscirman1@kickstarter.com    |Female    |Senior Executive       |36.18 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-01 00:00:00|I        |4  |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |5  |Sara      |Whiterod       |swhiterod4@hhs.gov           |Female    |Assistant Manager      |47.85 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |6  |Mariska   |Antrum         |mantrum5@nytimes.com         |Female    |Tax Accountant         |16.37 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |7  |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |8  |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |9  |Chaunce   |Holdforth      |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |10 |Blinni    |Fenty          |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-02 00:00:00|I        |11 |Davidde   |Legier         |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-02 00:00:00|I        |12 |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male      |Junior Executive       |36.18 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-02 00:00:00|I        |13 |Chic      |Ickowics       |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-02 00:00:00|I        |14 |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:17:05,367 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audit: line(34) : Auditing database table raw.cdc_customer
INFO : 2022-08-08 00:17:05,626 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audit: line(34) : Auditing database table raw.cdc_customer_history
INFO : 2022-08-08 00:17:05,800 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audits: line(48) : {
    "raw.cdc_customer": {
        "clusterId": null,
        "engineInfo": "Apache-Spark/3.2.1 Delta-Lake/2.0.0",
        "isBlindAppend": false,
        "isolationLevel": "Serializable",
        "job": null,
        "notebook": null,
        "operation": "MERGE",
        "operationMetrics": {
            "executionTimeMs": "12657",
            "numOutputRows": "6",
            "numSourceRows": "7",
            "numTargetChangeFilesAdded": "7",
            "numTargetFilesAdded": "6",
            "numTargetFilesRemoved": "3",
            "numTargetRowsCopied": "0",
            "numTargetRowsDeleted": "1",
            "numTargetRowsInserted": "4",
            "numTargetRowsUpdated": "2",
            "rewriteTimeMs": "11438",
            "scanTimeMs": "1216"
        },
        "operationParameters": {
            "matchedPredicates": "[{\"predicate\":\"((src.load_flag IN ('I', 'U')) AND (NOT (src.extract_date = dst.extract_date)))\",\"actionType\":\"update\"},{\"predicate\":\"(src.load_flag = 'D')\",\"actionType\":\"delete\"}]",
            "notMatchedPredicates": "[{\"predicate\":\"(src.load_flag IN ('I', 'U'))\",\"actionType\":\"insert\"}]",
            "predicate": "(dst.id = src.id)"
        },
        "readVersion": 11,
        "timestamp": "2022-08-08 00:17:00.128000",
        "userId": null,
        "userMetadata": null,
        "userName": null,
        "version": 12
    },
    "raw.cdc_customer_history": {
        "clusterId": null,
        "engineInfo": "Apache-Spark/3.2.1 Delta-Lake/2.0.0",
        "isBlindAppend": false,
        "isolationLevel": "Serializable",
        "job": null,
        "notebook": null,
        "operation": "MERGE",
        "operationMetrics": {
            "executionTimeMs": "2960",
            "numOutputRows": "4",
            "numSourceRows": "4",
            "numTargetChangeFilesAdded": "1",
            "numTargetFilesAdded": "1",
            "numTargetFilesRemoved": "0",
            "numTargetRowsCopied": "0",
            "numTargetRowsDeleted": "0",
            "numTargetRowsInserted": "4",
            "numTargetRowsUpdated": "0",
            "rewriteTimeMs": "1442",
            "scanTimeMs": "1515"
        },
        "operationParameters": {
            "matchedPredicates": "[{\"predicate\":\"(((NOT (dst.from_date = src.from_date)) OR (NOT (dst.to_date = src.to_date))) OR ((NOT (dst.version = src.version)) OR (NOT (dst.active = src.active))))\",\"actionType\":\"update\"}]",
            "notMatchedPredicates": "[{\"actionType\":\"insert\"}]",
            "predicate": "((dst.id = src.id) AND (dst.extract_date = src.extract_date))"
        },
        "readVersion": 11,
        "timestamp": "2022-08-08 00:16:39.130000",
        "userId": null,
        "userMetadata": null,
        "userName": null,
        "version": 12
    }
}
INFO : 2022-08-08 00:17:05,801 : cdc_customer_landing_to_rawdb_csv : _config_provider.py.load_config: line(41) : Loading Dataflow configuration from file /Users/shaunryan/AzureDevOps/yetl-patterns/config/pipeline/local/config.yaml
INFO : 2022-08-08 00:17:05,803 : cdc_customer_landing_to_rawdb_csv : _context.py._get_spark_context: line(85) : Setting spark context
INFO : 2022-08-08 00:17:05,807 : cdc_customer_landing_to_rawdb_csv : _context.py.__init__: line(50) : Setting application context spark logger at level ERROR
INFO : 2022-08-08 00:17:05,809 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_file_system_type: line(50) : Setting filestystem using protocol file:
INFO : 2022-08-08 00:17:05,809 : cdc_customer_landing_to_rawdb_csv : _context.py.__init__: line(66) : Setting application context dataflow cdc_customer_landing_to_rawdb_csv
INFO : 2022-08-08 00:17:05,809 : cdc_customer_landing_to_rawdb_csv : _config_provider.py.load_pipeline_config: line(29) : Loading Dataflow configuration from file /Users/shaunryan/AzureDevOps/yetl-patterns/config/pipeline/local/cdc_customer_landing_to_rawdb_csv.yaml
INFO : 2022-08-08 00:17:05,820 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on spark_schema_file 
INFO : 2022-08-08 00:17:05,820 : cdc_customer_landing_to_rawdb_csv : _spark_file_schema_repo.py.load_schema: line(50) : Loading schema for dataset landing.cdc_customer from /Users/shaunryan/AzureDevOps/yetl-patterns/config/schema/spark/landing/cdc_customer.yaml using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:17:05,825 : cdc_customer_landing_to_rawdb_csv : _reader.py.__init__: line(49) : auto_io = True automatically creating or altering exception delta table landing.cdc_customer _correlation_id=3cf2c7f5-d05b-43cb-8490-1901ab9c380b
INFO : 2022-08-08 00:17:05,826 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `landing`
INFO : 2022-08-08 00:17:05,871 : cdc_customer_landing_to_rawdb_csv : _reader.py.create_or_alter_table: line(61) : Exception table already exists landing.exceptions at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/exceptions/landing/exceptions _correlation_id=3cf2c7f5-d05b-43cb-8490-1901ab9c380b
INFO : 2022-08-08 00:17:05,871 : cdc_customer_landing_to_rawdb_csv : _reader.py.read: line(195) : Reading data for landing.cdc_customer from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv with options {'mode': 'PERMISSIVE', 'inferSchema': False, 'header': True, 'timestampFormat': 'yyyy-MM-dd HH:mm:ss'} _correlation_id=3cf2c7f5-d05b-43cb-8490-1901ab9c380b
INFO : 2022-08-08 00:17:05,890 : cdc_customer_landing_to_rawdb_csv : _reader.py.validate: line(181) : Validating dataframe read using PERMISSIVE corrupt column at _corrupt_record _correlation_id=3cf2c7f5-d05b-43cb-8490-1901ab9c380b
INFO : 2022-08-08 00:17:06,093 : cdc_customer_landing_to_rawdb_csv : _reader.py.validate: line(192) : {
    "validation": {
        "schema_on_read": {
            "landing.cdc_customer": {
                "total_count": 7,
                "valid_count": 7,
                "exception_count": 0
            }
        }
    }
}
INFO : 2022-08-08 00:17:06,093 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on deltalake_sql_file 
INFO : 2022-08-08 00:17:06,094 : cdc_customer_landing_to_rawdb_csv : _deltalake_sql_file.py.load_schema: line(43) : Loading schema for dataset raw.cdc_customer from ./config/schema/deltalake/raw/cdc_customer.sql using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:17:06,094 : cdc_customer_landing_to_rawdb_csv : _writer.py.__init__: line(40) : auto_io = True automatically creating or altering delta table raw.cdc_customer
INFO : 2022-08-08 00:17:06,094 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `raw`
INFO : 2022-08-08 00:17:06,126 : cdc_customer_landing_to_rawdb_csv : _writer.py.create_or_alter_table: line(88) : Table already exists raw.cdc_customer at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer
INFO : 2022-08-08 00:17:06,126 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(69) : getting existing table properties for table raw.cdc_customer
INFO : 2022-08-08 00:17:06,157 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(91) : {
    "raw.cdc_customer": {
        "constraints": {
            "amount_lower_bound": "amount > - 1000",
            "amount_upper_bound": "amount < 1000000"
        },
        "properties": {
            "Type": "EXTERNAL",
            "delta.appendOnly": "False",
            "delta.checkpoint.writeStatsAsJson": "True",
            "delta.compatibility.symlinkFormatManifest.enabled": "False",
            "delta.dataSkippingNumIndexedCols": "-1",
            "delta.deletedFileRetentionDuration": "interval 1 week",
            "delta.enableChangeDataFeed": "True",
            "delta.logRetentionDuration": "interval 30 days",
            "delta.minReaderVersion": "1",
            "delta.minWriterVersion": "4",
            "delta.randomPrefixLength": "2",
            "delta.randomizeFilePrefixes": "False",
            "external": "true"
        }
    }
}
INFO : 2022-08-08 00:17:11,283 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on deltalake_sql_file 
INFO : 2022-08-08 00:17:11,284 : cdc_customer_landing_to_rawdb_csv : _deltalake_sql_file.py.load_schema: line(43) : Loading schema for dataset raw.cdc_customer_history from ./config/schema/deltalake/raw/cdc_customer_history.sql using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:17:11,284 : cdc_customer_landing_to_rawdb_csv : _writer.py.__init__: line(40) : auto_io = True automatically creating or altering delta table raw.cdc_customer_history
INFO : 2022-08-08 00:17:11,284 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `raw`
INFO : 2022-08-08 00:17:11,317 : cdc_customer_landing_to_rawdb_csv : _writer.py.create_or_alter_table: line(88) : Table already exists raw.cdc_customer_history at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer_history
INFO : 2022-08-08 00:17:11,317 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(69) : getting existing table properties for table raw.cdc_customer_history
INFO : 2022-08-08 00:17:11,337 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(91) : {
    "raw.cdc_customer_history": {
        "constraints": {
            "amount_lower_bound": "amount > - 1000",
            "amount_upper_bound": "amount < 1000000"
        },
        "properties": {
            "Type": "EXTERNAL",
            "delta.appendOnly": "False",
            "delta.checkpoint.writeStatsAsJson": "True",
            "delta.compatibility.symlinkFormatManifest.enabled": "False",
            "delta.dataSkippingNumIndexedCols": "-1",
            "delta.deletedFileRetentionDuration": "interval 1 week",
            "delta.enableChangeDataFeed": "True",
            "delta.logRetentionDuration": "interval 30 days",
            "delta.minReaderVersion": "1",
            "delta.minWriterVersion": "4",
            "delta.randomPrefixLength": "2",
            "delta.randomizeFilePrefixes": "False",
            "external": "true"
        }
    }
}
INFO : 2022-08-08 00:17:16,350 : cdc_customer_landing_to_rawdb_csv : _framework.py.wrap_function: line(36) : Executing Dataflow cdc_customer_landing_to_rawdb_csv with:
                timeslice=2022-08-02 00:00:00.000000 
                retries=1 
                save_type=DefaultSave
INFO : 2022-08-08 00:17:16,378 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(34) : Fetched dst delta table raw.cdc_customer from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer
INFO : 2022-08-08 00:17:16,389 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(41) : Fetched dst delta table raw.cdc_customer_history from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer_history
INFO : 2022-08-08 00:17:16,545 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(95) : Change set
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+-----------+-------+------------+--------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender |job_title           |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |data_name  |next_id|next_version|next_from_date|
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+-----------+-------+------------+--------------+
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Super Hero          |86.5  |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|src        |null   |null        |null          |
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|dst_history|1      |2           |2008-01-01    |
|2  |2008-01-02 00:00:00|U        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Female |Senior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|src        |null   |null        |null          |
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|dst_history|2      |2           |2008-01-01    |
|3  |2008-01-02 00:00:00|D        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |false |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|src        |null   |null        |null          |
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|dst_history|3      |2           |2008-01-01    |
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|src        |null   |null        |null          |
|12 |2008-01-02 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|src        |null   |null        |null          |
|13 |2008-01-02 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|src        |null   |null        |null          |
|14 |2008-01-02 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV|73.21 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|src        |null   |null        |null          |
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+-----------+-------+------------+--------------+

INFO : 2022-08-08 00:17:19,061 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(104) : Change Set for Delete
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender |job_title           |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Super Hero          |86.5  |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2  |2008-01-02 00:00:00|U        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Female |Senior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-02 00:00:00|D        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |false |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|12 |2008-01-02 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|13 |2008-01-02 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|14 |2008-01-02 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV|73.21 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

+---+-------------------+---------+----------+---------+-------------------------+-------+------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name|email                    |gender |job_title         |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------+-------------------------+-------+------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier   |dlegier0@mail.ru         |Agender|Editor            |86.5  |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman  |pscirman1@kickstarter.com|Male   |Junior Executive  |36.18 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-02 00:00:00|D        |Chic      |Ickowics |cickowics2@booking.com   |Male   |Research Associate|35.54 |2008-01-02|9999-12-31|1      |false |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics |cickowics2@booking.com   |Male   |Research Associate|35.54 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
+---+-------------------+---------+----------+---------+-------------------------+-------+------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:17:30,593 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(132) : History
+-------------------+---------+---+----------+---------+-------------------------+-------+------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|extract_date       |load_flag|id |first_name|last_name|email                    |gender |job_title         |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+-------------------+---------+---+----------+---------+-------------------------+-------+------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|2008-01-01 00:00:00|I        |1  |Davidde   |Legier   |dlegier0@mail.ru         |Agender|Editor            |86.5  |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |2  |Panchito  |Scirman  |pscirman1@kickstarter.com|Male   |Junior Executive  |36.18 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |3  |Chic      |Ickowics |cickowics2@booking.com   |Male   |Research Associate|35.54 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-02 00:00:00|D        |3  |Chic      |Ickowics |cickowics2@booking.com   |Male   |Research Associate|35.54 |2008-01-02|9999-12-31|1      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
+-------------------+---------+---+----------+---------+-------------------------+-------+------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:17:30,920 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(137) : Change Set for Current
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender |job_title           |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Super Hero          |86.5  |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2  |2008-01-02 00:00:00|U        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Female |Senior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2  |2008-01-01 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-02 00:00:00|D        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |false |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|12 |2008-01-02 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|13 |2008-01-02 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|14 |2008-01-02 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV|73.21 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender |job_title           |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Super Hero          |86.5  |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2  |2008-01-02 00:00:00|U        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Female |Senior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|3  |2008-01-02 00:00:00|D        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |false |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier         |dlegier0@mail.ru             |Agender|Editor              |86.5  |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|12 |2008-01-02 00:00:00|I        |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male   |Junior Executive    |36.18 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|13 |2008-01-02 00:00:00|I        |Chic      |Ickowics       |cickowics2@booking.com       |Male   |Research Associate  |35.54 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|14 |2008-01-02 00:00:00|I        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV|73.21 |2008-01-02|9999-12-31|1      |true  |3cf2c7f5-d05b-43cb-8490-1901ab9c380b|2022-08-08 00:17:05.938547|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
+---+-------------------+---------+----------+---------------+-----------------------------+-------+--------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:17:52,308 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(154) : Current
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|extract_date       |load_flag|id |first_name|last_name      |email                        |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|2008-01-02 00:00:00|U        |1  |Davidde   |Legier         |dlegier0@mail.ru             |Agender   |Super Hero             |86.5  |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-02 00:00:00|U        |2  |Panchito  |Scirman        |pscirman1@kickstarter.com    |Female    |Senior Executive       |36.18 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-01 00:00:00|I        |4  |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |5  |Sara      |Whiterod       |swhiterod4@hhs.gov           |Female    |Assistant Manager      |47.85 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |6  |Mariska   |Antrum         |mantrum5@nytimes.com         |Female    |Tax Accountant         |16.37 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |7  |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |8  |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |9  |Chaunce   |Holdforth      |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |10 |Blinni    |Fenty          |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-02 00:00:00|I        |11 |Davidde   |Legier         |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-02 00:00:00|I        |12 |Panchito  |Scirman        |pscirman1@kickstarter.com    |Male      |Junior Executive       |36.18 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-02 00:00:00|I        |13 |Chic      |Ickowics       |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-02 00:00:00|I        |14 |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:17:52,643 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audit: line(34) : Auditing database table raw.cdc_customer
INFO : 2022-08-08 00:17:52,895 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audit: line(34) : Auditing database table raw.cdc_customer_history
INFO : 2022-08-08 00:17:53,069 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audits: line(48) : {
    "raw.cdc_customer": {
        "clusterId": null,
        "engineInfo": "Apache-Spark/3.2.1 Delta-Lake/2.0.0",
        "isBlindAppend": false,
        "isolationLevel": "Serializable",
        "job": null,
        "notebook": null,
        "operation": "MERGE",
        "operationMetrics": {
            "executionTimeMs": "12447",
            "numOutputRows": "6",
            "numSourceRows": "7",
            "numTargetChangeFilesAdded": "0",
            "numTargetFilesAdded": "6",
            "numTargetFilesRemoved": "6",
            "numTargetRowsCopied": "6",
            "numTargetRowsDeleted": "0",
            "numTargetRowsInserted": "0",
            "numTargetRowsUpdated": "0",
            "rewriteTimeMs": "11262",
            "scanTimeMs": "1182"
        },
        "operationParameters": {
            "matchedPredicates": "[{\"predicate\":\"((src.load_flag IN ('I', 'U')) AND (NOT (src.extract_date = dst.extract_date)))\",\"actionType\":\"update\"},{\"predicate\":\"(src.load_flag = 'D')\",\"actionType\":\"delete\"}]",
            "notMatchedPredicates": "[{\"predicate\":\"(src.load_flag IN ('I', 'U'))\",\"actionType\":\"insert\"}]",
            "predicate": "(dst.id = src.id)"
        },
        "readVersion": 15,
        "timestamp": "2022-08-08 00:17:46.426000",
        "userId": null,
        "userMetadata": null,
        "userName": null,
        "version": 16
    },
    "raw.cdc_customer_history": {
        "clusterId": null,
        "engineInfo": "Apache-Spark/3.2.1 Delta-Lake/2.0.0",
        "isBlindAppend": false,
        "isolationLevel": "Serializable",
        "job": null,
        "notebook": null,
        "operation": "MERGE",
        "operationMetrics": {
            "executionTimeMs": "2567",
            "numOutputRows": "4",
            "numSourceRows": "4",
            "numTargetChangeFilesAdded": "0",
            "numTargetFilesAdded": "1",
            "numTargetFilesRemoved": "1",
            "numTargetRowsCopied": "4",
            "numTargetRowsDeleted": "0",
            "numTargetRowsInserted": "0",
            "numTargetRowsUpdated": "0",
            "rewriteTimeMs": "1430",
            "scanTimeMs": "1134"
        },
        "operationParameters": {
            "matchedPredicates": "[{\"predicate\":\"(((NOT (dst.from_date = src.from_date)) OR (NOT (dst.to_date = src.to_date))) OR ((NOT (dst.version = src.version)) OR (NOT (dst.active = src.active))))\",\"actionType\":\"update\"}]",
            "notMatchedPredicates": "[{\"actionType\":\"insert\"}]",
            "predicate": "((dst.id = src.id) AND (dst.extract_date = src.extract_date))"
        },
        "readVersion": 15,
        "timestamp": "2022-08-08 00:17:24.667000",
        "userId": null,
        "userMetadata": null,
        "userName": null,
        "version": 16
    }
}
INFO : 2022-08-08 00:17:53,070 : cdc_customer_landing_to_rawdb_csv : _config_provider.py.load_config: line(41) : Loading Dataflow configuration from file /Users/shaunryan/AzureDevOps/yetl-patterns/config/pipeline/local/config.yaml
INFO : 2022-08-08 00:17:53,072 : cdc_customer_landing_to_rawdb_csv : _context.py._get_spark_context: line(85) : Setting spark context
INFO : 2022-08-08 00:17:53,076 : cdc_customer_landing_to_rawdb_csv : _context.py.__init__: line(50) : Setting application context spark logger at level ERROR
INFO : 2022-08-08 00:17:53,078 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_file_system_type: line(50) : Setting filestystem using protocol file:
INFO : 2022-08-08 00:17:53,079 : cdc_customer_landing_to_rawdb_csv : _context.py.__init__: line(66) : Setting application context dataflow cdc_customer_landing_to_rawdb_csv
INFO : 2022-08-08 00:17:53,079 : cdc_customer_landing_to_rawdb_csv : _config_provider.py.load_pipeline_config: line(29) : Loading Dataflow configuration from file /Users/shaunryan/AzureDevOps/yetl-patterns/config/pipeline/local/cdc_customer_landing_to_rawdb_csv.yaml
INFO : 2022-08-08 00:17:53,090 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on spark_schema_file 
INFO : 2022-08-08 00:17:53,090 : cdc_customer_landing_to_rawdb_csv : _spark_file_schema_repo.py.load_schema: line(50) : Loading schema for dataset landing.cdc_customer from /Users/shaunryan/AzureDevOps/yetl-patterns/config/schema/spark/landing/cdc_customer.yaml using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:17:53,095 : cdc_customer_landing_to_rawdb_csv : _reader.py.__init__: line(49) : auto_io = True automatically creating or altering exception delta table landing.cdc_customer _correlation_id=cef08b6b-b9d5-45fd-806b-93564d131835
INFO : 2022-08-08 00:17:53,095 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `landing`
INFO : 2022-08-08 00:17:53,139 : cdc_customer_landing_to_rawdb_csv : _reader.py.create_or_alter_table: line(61) : Exception table already exists landing.exceptions at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/exceptions/landing/exceptions _correlation_id=cef08b6b-b9d5-45fd-806b-93564d131835
INFO : 2022-08-08 00:17:53,139 : cdc_customer_landing_to_rawdb_csv : _reader.py.read: line(195) : Reading data for landing.cdc_customer from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv with options {'mode': 'PERMISSIVE', 'inferSchema': False, 'header': True, 'timestampFormat': 'yyyy-MM-dd HH:mm:ss'} _correlation_id=cef08b6b-b9d5-45fd-806b-93564d131835
INFO : 2022-08-08 00:17:53,157 : cdc_customer_landing_to_rawdb_csv : _reader.py.validate: line(181) : Validating dataframe read using PERMISSIVE corrupt column at _corrupt_record _correlation_id=cef08b6b-b9d5-45fd-806b-93564d131835
INFO : 2022-08-08 00:17:53,357 : cdc_customer_landing_to_rawdb_csv : _reader.py.validate: line(192) : {
    "validation": {
        "schema_on_read": {
            "landing.cdc_customer": {
                "total_count": 11,
                "valid_count": 11,
                "exception_count": 0
            }
        }
    }
}
INFO : 2022-08-08 00:17:53,358 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on deltalake_sql_file 
INFO : 2022-08-08 00:17:53,358 : cdc_customer_landing_to_rawdb_csv : _deltalake_sql_file.py.load_schema: line(43) : Loading schema for dataset raw.cdc_customer from ./config/schema/deltalake/raw/cdc_customer.sql using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:17:53,358 : cdc_customer_landing_to_rawdb_csv : _writer.py.__init__: line(40) : auto_io = True automatically creating or altering delta table raw.cdc_customer
INFO : 2022-08-08 00:17:53,358 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `raw`
INFO : 2022-08-08 00:17:53,389 : cdc_customer_landing_to_rawdb_csv : _writer.py.create_or_alter_table: line(88) : Table already exists raw.cdc_customer at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer
INFO : 2022-08-08 00:17:53,389 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(69) : getting existing table properties for table raw.cdc_customer
INFO : 2022-08-08 00:17:53,420 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(91) : {
    "raw.cdc_customer": {
        "constraints": {
            "amount_lower_bound": "amount > - 1000",
            "amount_upper_bound": "amount < 1000000"
        },
        "properties": {
            "Type": "EXTERNAL",
            "delta.appendOnly": "False",
            "delta.checkpoint.writeStatsAsJson": "True",
            "delta.compatibility.symlinkFormatManifest.enabled": "False",
            "delta.dataSkippingNumIndexedCols": "-1",
            "delta.deletedFileRetentionDuration": "interval 1 week",
            "delta.enableChangeDataFeed": "True",
            "delta.logRetentionDuration": "interval 30 days",
            "delta.minReaderVersion": "1",
            "delta.minWriterVersion": "4",
            "delta.randomPrefixLength": "2",
            "delta.randomizeFilePrefixes": "False",
            "external": "true"
        }
    }
}
INFO : 2022-08-08 00:17:58,545 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on deltalake_sql_file 
INFO : 2022-08-08 00:17:58,545 : cdc_customer_landing_to_rawdb_csv : _deltalake_sql_file.py.load_schema: line(43) : Loading schema for dataset raw.cdc_customer_history from ./config/schema/deltalake/raw/cdc_customer_history.sql using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:17:58,545 : cdc_customer_landing_to_rawdb_csv : _writer.py.__init__: line(40) : auto_io = True automatically creating or altering delta table raw.cdc_customer_history
INFO : 2022-08-08 00:17:58,545 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `raw`
INFO : 2022-08-08 00:17:58,577 : cdc_customer_landing_to_rawdb_csv : _writer.py.create_or_alter_table: line(88) : Table already exists raw.cdc_customer_history at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer_history
INFO : 2022-08-08 00:17:58,577 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(69) : getting existing table properties for table raw.cdc_customer_history
INFO : 2022-08-08 00:17:58,598 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(91) : {
    "raw.cdc_customer_history": {
        "constraints": {
            "amount_lower_bound": "amount > - 1000",
            "amount_upper_bound": "amount < 1000000"
        },
        "properties": {
            "Type": "EXTERNAL",
            "delta.appendOnly": "False",
            "delta.checkpoint.writeStatsAsJson": "True",
            "delta.compatibility.symlinkFormatManifest.enabled": "False",
            "delta.dataSkippingNumIndexedCols": "-1",
            "delta.deletedFileRetentionDuration": "interval 1 week",
            "delta.enableChangeDataFeed": "True",
            "delta.logRetentionDuration": "interval 30 days",
            "delta.minReaderVersion": "1",
            "delta.minWriterVersion": "4",
            "delta.randomPrefixLength": "2",
            "delta.randomizeFilePrefixes": "False",
            "external": "true"
        }
    }
}
INFO : 2022-08-08 00:18:03,651 : cdc_customer_landing_to_rawdb_csv : _framework.py.wrap_function: line(36) : Executing Dataflow cdc_customer_landing_to_rawdb_csv with:
                timeslice=2022-08-03 00:00:00.000000 
                retries=1 
                save_type=DefaultSave
INFO : 2022-08-08 00:18:03,680 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(34) : Fetched dst delta table raw.cdc_customer from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer
INFO : 2022-08-08 00:18:03,689 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(41) : Fetched dst delta table raw.cdc_customer_history from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer_history
INFO : 2022-08-08 00:18:03,835 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(95) : Change set
+---+-------------------+---------+----------+-----------------+---------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+-----------+-------+------------+--------------+
|id |extract_date       |load_flag|first_name|last_name        |email                      |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |data_name  |next_id|next_version|next_from_date|
+---+-------------------+---------+----------+-----------------+---------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+-----------+-------+------------+--------------+
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru           |Agender   |Editor                 |86.5  |2008-01-01|2008-01-01|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|dst_history|1      |3           |2008-01-01    |
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru           |Agender   |Super Hero             |86.5  |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|dst_current|1      |2           |2008-01-02    |
|1  |2008-01-03 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru           |Agender   |Super Villain          |86.5  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|src        |null   |null        |null          |
|3  |2008-01-03 00:00:00|I        |Chic      |Ickowics         |wowiback@booking.com       |Male      |Research Associate     |35.54 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|src        |null   |null        |null          |
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics         |cickowics2@booking.com     |Male      |Research Associate     |35.54 |2008-01-01|2008-01-01|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|dst_history|3      |3           |2008-01-01    |
|3  |2008-01-02 00:00:00|D        |Chic      |Ickowics         |cickowics2@booking.com     |Male      |Research Associate     |35.54 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|dst_history|3      |2           |2008-01-02    |
|8  |2008-01-03 00:00:00|U        |Anstice   |Hollingdale Sauce|ahollingdale7@yahoo.co.jp  |Female    |Cost Accountant        |21.94 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|src        |null   |null        |null          |
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale      |ahollingdale7@yahoo.co.jp  |Female    |Cost Accountant        |21.94 |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|dst_current|8      |2           |2008-01-02    |
|9  |2008-01-03 00:00:00|D        |Chaunce   |Holdforth        |choldforth8@ca.gov         |Non-binary|Chief Design Engineer  |72.0  |2008-01-03|9999-12-31|1      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|src        |null   |null        |null          |
|9  |2008-01-01 00:00:00|I        |Chaunce   |Holdforth        |choldforth8@ca.gov         |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|dst_current|9      |2           |2008-01-02    |
|10 |2008-01-01 00:00:00|I        |Blinni    |Fenty            |bfenty9@paginegialle.it    |Female    |Assistant Media Planner|38.98 |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|dst_current|10     |2           |2008-01-02    |
|10 |2008-01-03 00:00:00|U        |Blinni    |Blimey           |bfenty9@paginegialle.it    |Female    |Assistant Media Planner|38.98 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|src        |null   |null        |null          |
|11 |2008-01-03 00:00:00|U        |Tom       |Jerry            |dlegier0@mail.ru           |Agender   |Editor                 |86.5  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|src        |null   |null        |null          |
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru           |Agender   |Editor                 |86.5  |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|dst_current|11     |2           |2008-01-02    |
|12 |2008-01-03 00:00:00|U        |Panchito  |Scirman          |pscirman1@failedstarter.com|Male      |Junior Executive       |36.18 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|src        |null   |null        |null          |
|12 |2008-01-02 00:00:00|I        |Panchito  |Scirman          |pscirman1@kickstarter.com  |Male      |Junior Executive       |36.18 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|dst_current|12     |2           |2008-01-02    |
|13 |2008-01-02 00:00:00|I        |Chic      |Ickowics         |cickowics2@booking.com     |Male      |Research Associate     |35.54 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|dst_current|13     |2           |2008-01-02    |
|13 |2008-01-03 00:00:00|D        |Chic      |Ickowics         |cickowics2@booking.com     |Male      |Research Associate     |100.0 |2008-01-03|9999-12-31|1      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|src        |null   |null        |null          |
|15 |2008-01-03 00:00:00|I        |Sara      |Whiterod         |swhiterod4@hhs.gov         |Female    |Assistant Manager      |47.85 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|src        |null   |null        |null          |
|16 |2008-01-03 00:00:00|I        |Mariska   |Antrum           |mantrum5@nytimes.com       |Female    |Tax Accountant         |16.37 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|src        |null   |null        |null          |
+---+-------------------+---------+----------+-----------------+---------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+-----------+-------+------------+--------------+
only showing top 20 rows

INFO : 2022-08-08 00:18:06,343 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(104) : Change Set for Delete
+---+-------------------+---------+----------+-----------------+---------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name        |email                      |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+-----------------+---------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-03 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru           |Agender   |Super Villain          |86.5  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru           |Agender   |Super Hero             |86.5  |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru           |Agender   |Editor                 |86.5  |2008-01-01|2008-01-01|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics         |cickowics2@booking.com     |Male      |Research Associate     |35.54 |2008-01-01|2008-01-01|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-03 00:00:00|I        |Chic      |Ickowics         |wowiback@booking.com       |Male      |Research Associate     |35.54 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|3  |2008-01-02 00:00:00|D        |Chic      |Ickowics         |cickowics2@booking.com     |Male      |Research Associate     |35.54 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|8  |2008-01-03 00:00:00|U        |Anstice   |Hollingdale Sauce|ahollingdale7@yahoo.co.jp  |Female    |Cost Accountant        |21.94 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale      |ahollingdale7@yahoo.co.jp  |Female    |Cost Accountant        |21.94 |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|9  |2008-01-01 00:00:00|I        |Chaunce   |Holdforth        |choldforth8@ca.gov         |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|9  |2008-01-03 00:00:00|D        |Chaunce   |Holdforth        |choldforth8@ca.gov         |Non-binary|Chief Design Engineer  |72.0  |2008-01-03|9999-12-31|1      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|10 |2008-01-03 00:00:00|U        |Blinni    |Blimey           |bfenty9@paginegialle.it    |Female    |Assistant Media Planner|38.98 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|10 |2008-01-01 00:00:00|I        |Blinni    |Fenty            |bfenty9@paginegialle.it    |Female    |Assistant Media Planner|38.98 |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|11 |2008-01-03 00:00:00|U        |Tom       |Jerry            |dlegier0@mail.ru           |Agender   |Editor                 |86.5  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru           |Agender   |Editor                 |86.5  |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|12 |2008-01-02 00:00:00|I        |Panchito  |Scirman          |pscirman1@kickstarter.com  |Male      |Junior Executive       |36.18 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|12 |2008-01-03 00:00:00|U        |Panchito  |Scirman          |pscirman1@failedstarter.com|Male      |Junior Executive       |36.18 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|13 |2008-01-03 00:00:00|D        |Chic      |Ickowics         |cickowics2@booking.com     |Male      |Research Associate     |100.0 |2008-01-03|9999-12-31|1      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|13 |2008-01-02 00:00:00|I        |Chic      |Ickowics         |cickowics2@booking.com     |Male      |Research Associate     |35.54 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|15 |2008-01-03 00:00:00|I        |Sara      |Whiterod         |swhiterod4@hhs.gov         |Female    |Assistant Manager      |47.85 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|16 |2008-01-03 00:00:00|I        |Mariska   |Antrum           |mantrum5@nytimes.com       |Female    |Tax Accountant         |16.37 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
+---+-------------------+---------+----------+-----------------+---------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
only showing top 20 rows

+---+-------------------+---------+----------+-----------+-------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name  |email                    |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+-----------+-------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier     |dlegier0@mail.ru         |Agender   |Super Hero             |86.5  |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier     |dlegier0@mail.ru         |Agender   |Editor                 |86.5  |2008-01-01|2008-01-01|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|3  |2008-01-02 00:00:00|D        |Chic      |Ickowics   |cickowics2@booking.com   |Male      |Research Associate     |35.54 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics   |cickowics2@booking.com   |Male      |Research Associate     |35.54 |2008-01-01|2008-01-01|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale|ahollingdale7@yahoo.co.jp|Female    |Cost Accountant        |21.94 |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|9  |2008-01-03 00:00:00|D        |Chaunce   |Holdforth  |choldforth8@ca.gov       |Non-binary|Chief Design Engineer  |72.0  |2008-01-03|9999-12-31|1      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|9  |2008-01-01 00:00:00|I        |Chaunce   |Holdforth  |choldforth8@ca.gov       |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|10 |2008-01-01 00:00:00|I        |Blinni    |Fenty      |bfenty9@paginegialle.it  |Female    |Assistant Media Planner|38.98 |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier     |dlegier0@mail.ru         |Agender   |Editor                 |86.5  |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|12 |2008-01-02 00:00:00|I        |Panchito  |Scirman    |pscirman1@kickstarter.com|Male      |Junior Executive       |36.18 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|13 |2008-01-03 00:00:00|D        |Chic      |Ickowics   |cickowics2@booking.com   |Male      |Research Associate     |100.0 |2008-01-03|9999-12-31|1      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|13 |2008-01-02 00:00:00|I        |Chic      |Ickowics   |cickowics2@booking.com   |Male      |Research Associate     |35.54 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
+---+-------------------+---------+----------+-----------+-------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:18:19,509 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(132) : History
+-------------------+---------+---+----------+-----------+-------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|extract_date       |load_flag|id |first_name|last_name  |email                    |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+-------------------+---------+---+----------+-----------+-------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|2008-01-02 00:00:00|U        |1  |Davidde   |Legier     |dlegier0@mail.ru         |Agender   |Super Hero             |86.5  |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-01 00:00:00|I        |1  |Davidde   |Legier     |dlegier0@mail.ru         |Agender   |Editor                 |86.5  |2008-01-01|2008-01-01|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |2  |Panchito  |Scirman    |pscirman1@kickstarter.com|Male      |Junior Executive       |36.18 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |3  |Chic      |Ickowics   |cickowics2@booking.com   |Male      |Research Associate     |35.54 |2008-01-01|2008-01-01|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-02 00:00:00|D        |3  |Chic      |Ickowics   |cickowics2@booking.com   |Male      |Research Associate     |35.54 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-01 00:00:00|I        |8  |Anstice   |Hollingdale|ahollingdale7@yahoo.co.jp|Female    |Cost Accountant        |21.94 |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-03 00:00:00|D        |9  |Chaunce   |Holdforth  |choldforth8@ca.gov       |Non-binary|Chief Design Engineer  |72.0  |2008-01-03|9999-12-31|1      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-01 00:00:00|I        |9  |Chaunce   |Holdforth  |choldforth8@ca.gov       |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |10 |Blinni    |Fenty      |bfenty9@paginegialle.it  |Female    |Assistant Media Planner|38.98 |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-02 00:00:00|I        |11 |Davidde   |Legier     |dlegier0@mail.ru         |Agender   |Editor                 |86.5  |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-02 00:00:00|I        |12 |Panchito  |Scirman    |pscirman1@kickstarter.com|Male      |Junior Executive       |36.18 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-02 00:00:00|I        |13 |Chic      |Ickowics   |cickowics2@booking.com   |Male      |Research Associate     |35.54 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-03 00:00:00|D        |13 |Chic      |Ickowics   |cickowics2@booking.com   |Male      |Research Associate     |100.0 |2008-01-03|9999-12-31|1      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
+-------------------+---------+---+----------+-----------+-------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:18:19,822 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(137) : Change Set for Current
+---+-------------------+---------+----------+-----------------+-------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name        |email                    |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+-----------------+-------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru         |Agender   |Super Hero             |86.5  |2008-01-02|2008-01-01|3      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru         |Agender   |Editor                 |86.5  |2008-01-01|2008-01-01|4      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|1  |2008-01-03 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru         |Agender   |Super Villain          |86.5  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru         |Agender   |Super Hero             |86.5  |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|3  |2008-01-03 00:00:00|I        |Chic      |Ickowics         |wowiback@booking.com     |Male      |Research Associate     |35.54 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|3  |2008-01-02 00:00:00|D        |Chic      |Ickowics         |cickowics2@booking.com   |Male      |Research Associate     |35.54 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|3  |2008-01-01 00:00:00|I        |Chic      |Ickowics         |cickowics2@booking.com   |Male      |Research Associate     |35.54 |2008-01-01|2008-01-01|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale      |ahollingdale7@yahoo.co.jp|Female    |Cost Accountant        |21.94 |2008-01-01|2007-12-31|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|8  |2008-01-03 00:00:00|U        |Anstice   |Hollingdale Sauce|ahollingdale7@yahoo.co.jp|Female    |Cost Accountant        |21.94 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale      |ahollingdale7@yahoo.co.jp|Female    |Cost Accountant        |21.94 |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|9  |2008-01-03 00:00:00|D        |Chaunce   |Holdforth        |choldforth8@ca.gov       |Non-binary|Chief Design Engineer  |72.0  |2008-01-03|9999-12-31|1      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|9  |2008-01-01 00:00:00|I        |Chaunce   |Holdforth        |choldforth8@ca.gov       |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|2007-12-31|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|9  |2008-01-01 00:00:00|I        |Chaunce   |Holdforth        |choldforth8@ca.gov       |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|10 |2008-01-03 00:00:00|U        |Blinni    |Blimey           |bfenty9@paginegialle.it  |Female    |Assistant Media Planner|38.98 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|10 |2008-01-01 00:00:00|I        |Blinni    |Fenty            |bfenty9@paginegialle.it  |Female    |Assistant Media Planner|38.98 |2008-01-01|2007-12-31|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|10 |2008-01-01 00:00:00|I        |Blinni    |Fenty            |bfenty9@paginegialle.it  |Female    |Assistant Media Planner|38.98 |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|11 |2008-01-03 00:00:00|U        |Tom       |Jerry            |dlegier0@mail.ru         |Agender   |Editor                 |86.5  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru         |Agender   |Editor                 |86.5  |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru         |Agender   |Editor                 |86.5  |2008-01-02|2008-01-01|3      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|12 |2008-01-02 00:00:00|I        |Panchito  |Scirman          |pscirman1@kickstarter.com|Male      |Junior Executive       |36.18 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
+---+-------------------+---------+----------+-----------------+-------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
only showing top 20 rows

+---+-------------------+---------+----------+-----------------+---------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name        |email                      |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+-----------------+---------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-03 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru           |Agender   |Super Villain          |86.5  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|3  |2008-01-03 00:00:00|I        |Chic      |Ickowics         |wowiback@booking.com       |Male      |Research Associate     |35.54 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|8  |2008-01-03 00:00:00|U        |Anstice   |Hollingdale Sauce|ahollingdale7@yahoo.co.jp  |Female    |Cost Accountant        |21.94 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|9  |2008-01-03 00:00:00|D        |Chaunce   |Holdforth        |choldforth8@ca.gov         |Non-binary|Chief Design Engineer  |72.0  |2008-01-03|9999-12-31|1      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|10 |2008-01-03 00:00:00|U        |Blinni    |Blimey           |bfenty9@paginegialle.it    |Female    |Assistant Media Planner|38.98 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|11 |2008-01-03 00:00:00|U        |Tom       |Jerry            |dlegier0@mail.ru           |Agender   |Editor                 |86.5  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|12 |2008-01-03 00:00:00|U        |Panchito  |Scirman          |pscirman1@failedstarter.com|Male      |Junior Executive       |36.18 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|13 |2008-01-03 00:00:00|D        |Chic      |Ickowics         |cickowics2@booking.com     |Male      |Research Associate     |100.0 |2008-01-03|9999-12-31|1      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|15 |2008-01-03 00:00:00|I        |Sara      |Whiterod         |swhiterod4@hhs.gov         |Female    |Assistant Manager      |47.85 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|16 |2008-01-03 00:00:00|I        |Mariska   |Antrum           |mantrum5@nytimes.com       |Female    |Tax Accountant         |16.37 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|17 |2008-01-03 00:00:00|I        |Ingemar   |Petrus           |ipetrus6@blogspot.com      |Male      |Chief Design Engineer  |49.02 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
+---+-------------------+---------+----------+-----------------+---------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:18:42,927 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(154) : Current
+-------------------+---------+---+----------+-----------------+-----------------------------+-------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|extract_date       |load_flag|id |first_name|last_name        |email                        |gender |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+-------------------+---------+---+----------+-----------------+-----------------------------+-------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|2008-01-03 00:00:00|U        |1  |Davidde   |Legier           |dlegier0@mail.ru             |Agender|Super Villain          |86.5  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-02 00:00:00|U        |2  |Panchito  |Scirman          |pscirman1@kickstarter.com    |Female |Senior Executive       |36.18 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-03 00:00:00|I        |3  |Chic      |Ickowics         |wowiback@booking.com         |Male   |Research Associate     |35.54 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-01 00:00:00|I        |4  |Pascale   |Jedrzaszkiewicz  |pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV   |73.21 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |5  |Sara      |Whiterod         |swhiterod4@hhs.gov           |Female |Assistant Manager      |47.85 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |6  |Mariska   |Antrum           |mantrum5@nytimes.com         |Female |Tax Accountant         |16.37 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |7  |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male   |Chief Design Engineer  |49.02 |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-03 00:00:00|U        |8  |Anstice   |Hollingdale Sauce|ahollingdale7@yahoo.co.jp    |Female |Cost Accountant        |21.94 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-03 00:00:00|U        |10 |Blinni    |Blimey           |bfenty9@paginegialle.it      |Female |Assistant Media Planner|38.98 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-03 00:00:00|U        |11 |Tom       |Jerry            |dlegier0@mail.ru             |Agender|Editor                 |86.5  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-03 00:00:00|U        |12 |Panchito  |Scirman          |pscirman1@failedstarter.com  |Male   |Junior Executive       |36.18 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-02 00:00:00|I        |14 |Pascale   |Jedrzaszkiewicz  |pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV   |73.21 |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-03 00:00:00|I        |15 |Sara      |Whiterod         |swhiterod4@hhs.gov           |Female |Assistant Manager      |47.85 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-03 00:00:00|I        |16 |Mariska   |Antrum           |mantrum5@nytimes.com         |Female |Tax Accountant         |16.37 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-03 00:00:00|I        |17 |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male   |Chief Design Engineer  |49.02 |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
+-------------------+---------+---+----------+-----------------+-----------------------------+-------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:18:43,267 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audit: line(34) : Auditing database table raw.cdc_customer
INFO : 2022-08-08 00:18:43,514 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audit: line(34) : Auditing database table raw.cdc_customer_history
INFO : 2022-08-08 00:18:43,687 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audits: line(48) : {
    "raw.cdc_customer": {
        "clusterId": null,
        "engineInfo": "Apache-Spark/3.2.1 Delta-Lake/2.0.0",
        "isBlindAppend": false,
        "isolationLevel": "Serializable",
        "job": null,
        "notebook": null,
        "operation": "MERGE",
        "operationMetrics": {
            "executionTimeMs": "12651",
            "numOutputRows": "9",
            "numSourceRows": "11",
            "numTargetChangeFilesAdded": "10",
            "numTargetFilesAdded": "9",
            "numTargetFilesRemoved": "7",
            "numTargetRowsCopied": "0",
            "numTargetRowsDeleted": "2",
            "numTargetRowsInserted": "4",
            "numTargetRowsUpdated": "5",
            "rewriteTimeMs": "11465",
            "scanTimeMs": "1182"
        },
        "operationParameters": {
            "matchedPredicates": "[{\"predicate\":\"((src.load_flag IN ('I', 'U')) AND (NOT (src.extract_date = dst.extract_date)))\",\"actionType\":\"update\"},{\"predicate\":\"(src.load_flag = 'D')\",\"actionType\":\"delete\"}]",
            "notMatchedPredicates": "[{\"predicate\":\"(src.load_flag IN ('I', 'U'))\",\"actionType\":\"insert\"}]",
            "predicate": "(dst.id = src.id)"
        },
        "readVersion": 19,
        "timestamp": "2022-08-08 00:18:35.554000",
        "userId": null,
        "userMetadata": null,
        "userName": null,
        "version": 20
    },
    "raw.cdc_customer_history": {
        "clusterId": null,
        "engineInfo": "Apache-Spark/3.2.1 Delta-Lake/2.0.0",
        "isBlindAppend": false,
        "isolationLevel": "Serializable",
        "job": null,
        "notebook": null,
        "operation": "MERGE",
        "operationMetrics": {
            "executionTimeMs": "2592",
            "numOutputRows": "13",
            "numSourceRows": "12",
            "numTargetChangeFilesAdded": "1",
            "numTargetFilesAdded": "1",
            "numTargetFilesRemoved": "1",
            "numTargetRowsCopied": "1",
            "numTargetRowsDeleted": "0",
            "numTargetRowsInserted": "9",
            "numTargetRowsUpdated": "3",
            "rewriteTimeMs": "1469",
            "scanTimeMs": "1120"
        },
        "operationParameters": {
            "matchedPredicates": "[{\"predicate\":\"(((NOT (dst.from_date = src.from_date)) OR (NOT (dst.to_date = src.to_date))) OR ((NOT (dst.version = src.version)) OR (NOT (dst.active = src.active))))\",\"actionType\":\"update\"}]",
            "notMatchedPredicates": "[{\"actionType\":\"insert\"}]",
            "predicate": "((dst.id = src.id) AND (dst.extract_date = src.extract_date))"
        },
        "readVersion": 19,
        "timestamp": "2022-08-08 00:18:11.976000",
        "userId": null,
        "userMetadata": null,
        "userName": null,
        "version": 20
    }
}
INFO : 2022-08-08 00:18:43,687 : cdc_customer_landing_to_rawdb_csv : _config_provider.py.load_config: line(41) : Loading Dataflow configuration from file /Users/shaunryan/AzureDevOps/yetl-patterns/config/pipeline/local/config.yaml
INFO : 2022-08-08 00:18:43,689 : cdc_customer_landing_to_rawdb_csv : _context.py._get_spark_context: line(85) : Setting spark context
INFO : 2022-08-08 00:18:43,692 : cdc_customer_landing_to_rawdb_csv : _context.py.__init__: line(50) : Setting application context spark logger at level ERROR
INFO : 2022-08-08 00:18:43,695 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_file_system_type: line(50) : Setting filestystem using protocol file:
INFO : 2022-08-08 00:18:43,695 : cdc_customer_landing_to_rawdb_csv : _context.py.__init__: line(66) : Setting application context dataflow cdc_customer_landing_to_rawdb_csv
INFO : 2022-08-08 00:18:43,695 : cdc_customer_landing_to_rawdb_csv : _config_provider.py.load_pipeline_config: line(29) : Loading Dataflow configuration from file /Users/shaunryan/AzureDevOps/yetl-patterns/config/pipeline/local/cdc_customer_landing_to_rawdb_csv.yaml
INFO : 2022-08-08 00:18:43,706 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on spark_schema_file 
INFO : 2022-08-08 00:18:43,706 : cdc_customer_landing_to_rawdb_csv : _spark_file_schema_repo.py.load_schema: line(50) : Loading schema for dataset landing.cdc_customer from /Users/shaunryan/AzureDevOps/yetl-patterns/config/schema/spark/landing/cdc_customer.yaml using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:18:43,711 : cdc_customer_landing_to_rawdb_csv : _reader.py.__init__: line(49) : auto_io = True automatically creating or altering exception delta table landing.cdc_customer _correlation_id=d47b02ee-e5d8-41f1-8fca-97c699fa9f37
INFO : 2022-08-08 00:18:43,712 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `landing`
INFO : 2022-08-08 00:18:43,757 : cdc_customer_landing_to_rawdb_csv : _reader.py.create_or_alter_table: line(61) : Exception table already exists landing.exceptions at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/exceptions/landing/exceptions _correlation_id=d47b02ee-e5d8-41f1-8fca-97c699fa9f37
INFO : 2022-08-08 00:18:43,757 : cdc_customer_landing_to_rawdb_csv : _reader.py.read: line(195) : Reading data for landing.cdc_customer from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv with options {'mode': 'PERMISSIVE', 'inferSchema': False, 'header': True, 'timestampFormat': 'yyyy-MM-dd HH:mm:ss'} _correlation_id=d47b02ee-e5d8-41f1-8fca-97c699fa9f37
INFO : 2022-08-08 00:18:43,775 : cdc_customer_landing_to_rawdb_csv : _reader.py.validate: line(181) : Validating dataframe read using PERMISSIVE corrupt column at _corrupt_record _correlation_id=d47b02ee-e5d8-41f1-8fca-97c699fa9f37
INFO : 2022-08-08 00:18:43,960 : cdc_customer_landing_to_rawdb_csv : _reader.py.validate: line(192) : {
    "validation": {
        "schema_on_read": {
            "landing.cdc_customer": {
                "total_count": 9,
                "valid_count": 9,
                "exception_count": 0
            }
        }
    }
}
INFO : 2022-08-08 00:18:43,960 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on deltalake_sql_file 
INFO : 2022-08-08 00:18:43,960 : cdc_customer_landing_to_rawdb_csv : _deltalake_sql_file.py.load_schema: line(43) : Loading schema for dataset raw.cdc_customer from ./config/schema/deltalake/raw/cdc_customer.sql using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:18:43,960 : cdc_customer_landing_to_rawdb_csv : _writer.py.__init__: line(40) : auto_io = True automatically creating or altering delta table raw.cdc_customer
INFO : 2022-08-08 00:18:43,961 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `raw`
INFO : 2022-08-08 00:18:43,991 : cdc_customer_landing_to_rawdb_csv : _writer.py.create_or_alter_table: line(88) : Table already exists raw.cdc_customer at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer
INFO : 2022-08-08 00:18:43,991 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(69) : getting existing table properties for table raw.cdc_customer
INFO : 2022-08-08 00:18:44,021 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(91) : {
    "raw.cdc_customer": {
        "constraints": {
            "amount_lower_bound": "amount > - 1000",
            "amount_upper_bound": "amount < 1000000"
        },
        "properties": {
            "Type": "EXTERNAL",
            "delta.appendOnly": "False",
            "delta.checkpoint.writeStatsAsJson": "True",
            "delta.compatibility.symlinkFormatManifest.enabled": "False",
            "delta.dataSkippingNumIndexedCols": "-1",
            "delta.deletedFileRetentionDuration": "interval 1 week",
            "delta.enableChangeDataFeed": "True",
            "delta.logRetentionDuration": "interval 30 days",
            "delta.minReaderVersion": "1",
            "delta.minWriterVersion": "4",
            "delta.randomPrefixLength": "2",
            "delta.randomizeFilePrefixes": "False",
            "external": "true"
        }
    }
}
INFO : 2022-08-08 00:18:49,085 : cdc_customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on deltalake_sql_file 
INFO : 2022-08-08 00:18:49,086 : cdc_customer_landing_to_rawdb_csv : _deltalake_sql_file.py.load_schema: line(43) : Loading schema for dataset raw.cdc_customer_history from ./config/schema/deltalake/raw/cdc_customer_history.sql using <class 'yetl_flow.file_system._file_system.FileSystem'>
INFO : 2022-08-08 00:18:49,086 : cdc_customer_landing_to_rawdb_csv : _writer.py.__init__: line(40) : auto_io = True automatically creating or altering delta table raw.cdc_customer_history
INFO : 2022-08-08 00:18:49,086 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `raw`
INFO : 2022-08-08 00:18:49,119 : cdc_customer_landing_to_rawdb_csv : _writer.py.create_or_alter_table: line(88) : Table already exists raw.cdc_customer_history at file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer_history
INFO : 2022-08-08 00:18:49,120 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(69) : getting existing table properties for table raw.cdc_customer_history
INFO : 2022-08-08 00:18:49,139 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_table_properties: line(91) : {
    "raw.cdc_customer_history": {
        "constraints": {
            "amount_lower_bound": "amount > - 1000",
            "amount_upper_bound": "amount < 1000000"
        },
        "properties": {
            "Type": "EXTERNAL",
            "delta.appendOnly": "False",
            "delta.checkpoint.writeStatsAsJson": "True",
            "delta.compatibility.symlinkFormatManifest.enabled": "False",
            "delta.dataSkippingNumIndexedCols": "-1",
            "delta.deletedFileRetentionDuration": "interval 1 week",
            "delta.enableChangeDataFeed": "True",
            "delta.logRetentionDuration": "interval 30 days",
            "delta.minReaderVersion": "1",
            "delta.minWriterVersion": "4",
            "delta.randomPrefixLength": "2",
            "delta.randomizeFilePrefixes": "False",
            "external": "true"
        }
    }
}
INFO : 2022-08-08 00:18:54,119 : cdc_customer_landing_to_rawdb_csv : _framework.py.wrap_function: line(36) : Executing Dataflow cdc_customer_landing_to_rawdb_csv with:
                timeslice=2022-08-04 00:00:00.000000 
                retries=1 
                save_type=DefaultSave
INFO : 2022-08-08 00:18:54,146 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(34) : Fetched dst delta table raw.cdc_customer from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer
INFO : 2022-08-08 00:18:54,155 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(41) : Fetched dst delta table raw.cdc_customer_history from file:/Users/shaunryan/AzureDevOps/yetl-patterns/data/delta_lake/raw/cdc_customer_history
INFO : 2022-08-08 00:18:54,297 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(95) : Change set
+---+-------------------+---------+----------+-----------------+-----------------------------+----------+-----------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+-----------+-------+------------+--------------+
|id |extract_date       |load_flag|first_name|last_name        |email                        |gender    |job_title              |amount |from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |data_name  |next_id|next_version|next_from_date|
+---+-------------------+---------+----------+-----------------+-----------------------------+----------+-----------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+-----------+-------+------------+--------------+
|1  |2008-01-03 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru             |Agender   |Super Villain          |86.5   |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|dst_current|1      |2           |2008-01-03    |
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru             |Agender   |Super Hero             |86.5   |2008-01-02|2008-01-02|3      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|dst_history|1      |3           |2008-01-02    |
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru             |Agender   |Editor                 |86.5   |2008-01-01|2008-01-01|4      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|dst_history|1      |4           |2008-01-01    |
|1  |2008-01-04 00:00:00|U        |David     |Legier           |dlegier0@mail.ru             |Agender   |Super Hero             |86.5   |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|src        |null   |null        |null          |
|7  |2008-01-04 00:00:00|D        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02  |2008-01-04|9999-12-31|1      |false |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|src        |null   |null        |null          |
|7  |2008-01-01 00:00:00|I        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02  |2008-01-01|2008-01-03|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|dst_current|7      |2           |2008-01-03    |
|8  |2008-01-04 00:00:00|U        |Anstice   |Hollingdale      |ahollingdale7@yahoo.co.jp    |Female    |Profit Accountant      |21.94  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|src        |null   |null        |null          |
|8  |2008-01-03 00:00:00|U        |Anstice   |Hollingdale Sauce|ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94  |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|dst_current|8      |2           |2008-01-03    |
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale      |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94  |2008-01-01|2008-01-02|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|dst_history|8      |3           |2008-01-02    |
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru             |Agender   |Editor                 |86.5   |2008-01-02|2008-01-02|3      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|dst_history|11     |3           |2008-01-02    |
|11 |2008-01-03 00:00:00|U        |Tom       |Jerry            |dlegier0@mail.ru             |Agender   |Editor                 |86.5   |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|dst_current|11     |2           |2008-01-03    |
|11 |2008-01-04 00:00:00|U        |Tom       |Jerry            |dlegier0@mail.ru             |Agender   |PM of England          |10000.5|2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|src        |null   |null        |null          |
|14 |2008-01-04 00:00:00|D        |Pascale   |Jedrzaszkiewicz  |pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21  |2008-01-04|9999-12-31|1      |false |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|src        |null   |null        |null          |
|14 |2008-01-02 00:00:00|I        |Pascale   |Jedrzaszkiewicz  |pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21  |2008-01-02|2008-01-03|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|dst_current|14     |2           |2008-01-03    |
|17 |2008-01-04 00:00:00|I        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|src        |null   |null        |null          |
|17 |2008-01-03 00:00:00|I        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02  |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|dst_current|17     |2           |2008-01-03    |
|18 |2008-01-04 00:00:00|I        |Anstice   |Hollingdale      |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|src        |null   |null        |null          |
|19 |2008-01-04 00:00:00|I        |Chaunce   |Holdforth        |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0   |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|src        |null   |null        |null          |
|20 |2008-01-04 00:00:00|I        |Blinni    |Fenty            |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|src        |null   |null        |null          |
+---+-------------------+---------+----------+-----------------+-----------------------------+----------+-----------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+-----------+-------+------------+--------------+

INFO : 2022-08-08 00:18:56,810 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(104) : Change Set for Delete
+---+-------------------+---------+----------+-----------------+-----------------------------+----------+-----------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name        |email                        |gender    |job_title              |amount |from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+-----------------+-----------------------------+----------+-----------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-03 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru             |Agender   |Super Villain          |86.5   |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru             |Agender   |Super Hero             |86.5   |2008-01-02|2008-01-02|3      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru             |Agender   |Editor                 |86.5   |2008-01-01|2008-01-01|4      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|1  |2008-01-04 00:00:00|U        |David     |Legier           |dlegier0@mail.ru             |Agender   |Super Hero             |86.5   |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|7  |2008-01-04 00:00:00|D        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02  |2008-01-04|9999-12-31|1      |false |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|7  |2008-01-01 00:00:00|I        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02  |2008-01-01|2008-01-03|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|8  |2008-01-03 00:00:00|U        |Anstice   |Hollingdale Sauce|ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94  |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale      |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94  |2008-01-01|2008-01-02|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|8  |2008-01-04 00:00:00|U        |Anstice   |Hollingdale      |ahollingdale7@yahoo.co.jp    |Female    |Profit Accountant      |21.94  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru             |Agender   |Editor                 |86.5   |2008-01-02|2008-01-02|3      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|11 |2008-01-04 00:00:00|U        |Tom       |Jerry            |dlegier0@mail.ru             |Agender   |PM of England          |10000.5|2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|11 |2008-01-03 00:00:00|U        |Tom       |Jerry            |dlegier0@mail.ru             |Agender   |Editor                 |86.5   |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|14 |2008-01-04 00:00:00|D        |Pascale   |Jedrzaszkiewicz  |pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21  |2008-01-04|9999-12-31|1      |false |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|14 |2008-01-02 00:00:00|I        |Pascale   |Jedrzaszkiewicz  |pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21  |2008-01-02|2008-01-03|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|17 |2008-01-03 00:00:00|I        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02  |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|17 |2008-01-04 00:00:00|I        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|18 |2008-01-04 00:00:00|I        |Anstice   |Hollingdale      |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|19 |2008-01-04 00:00:00|I        |Chaunce   |Holdforth        |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0   |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|20 |2008-01-04 00:00:00|I        |Blinni    |Fenty            |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
+---+-------------------+---------+----------+-----------------+-----------------------------+----------+-----------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

+---+-------------------+---------+----------+-----------------+-----------------------------+-------+---------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name        |email                        |gender |job_title            |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+-----------------+-----------------------------+-------+---------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru             |Agender|Super Hero           |86.5  |2008-01-02|2008-01-02|3      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|1  |2008-01-03 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru             |Agender|Super Villain        |86.5  |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru             |Agender|Editor               |86.5  |2008-01-01|2008-01-01|4      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|7  |2008-01-04 00:00:00|D        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male   |Chief Design Engineer|49.02 |2008-01-04|9999-12-31|1      |false |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|7  |2008-01-01 00:00:00|I        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male   |Chief Design Engineer|49.02 |2008-01-01|2008-01-03|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|8  |2008-01-03 00:00:00|U        |Anstice   |Hollingdale Sauce|ahollingdale7@yahoo.co.jp    |Female |Cost Accountant      |21.94 |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale      |ahollingdale7@yahoo.co.jp    |Female |Cost Accountant      |21.94 |2008-01-01|2008-01-02|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|11 |2008-01-03 00:00:00|U        |Tom       |Jerry            |dlegier0@mail.ru             |Agender|Editor               |86.5  |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru             |Agender|Editor               |86.5  |2008-01-02|2008-01-02|3      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|14 |2008-01-04 00:00:00|D        |Pascale   |Jedrzaszkiewicz  |pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV |73.21 |2008-01-04|9999-12-31|1      |false |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|14 |2008-01-02 00:00:00|I        |Pascale   |Jedrzaszkiewicz  |pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV |73.21 |2008-01-02|2008-01-03|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|17 |2008-01-03 00:00:00|I        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male   |Chief Design Engineer|49.02 |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
+---+-------------------+---------+----------+-----------------+-----------------------------+-------+---------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:19:10,467 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(132) : History
+-------------------+---------+---+----------+-----------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|extract_date       |load_flag|id |first_name|last_name        |email                        |gender    |job_title              |amount|from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+-------------------+---------+---+----------+-----------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|2008-01-03 00:00:00|U        |1  |Davidde   |Legier           |dlegier0@mail.ru             |Agender   |Super Villain          |86.5  |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-02 00:00:00|U        |1  |Davidde   |Legier           |dlegier0@mail.ru             |Agender   |Super Hero             |86.5  |2008-01-02|2008-01-02|3      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-01 00:00:00|I        |1  |Davidde   |Legier           |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-01|2008-01-01|4      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |2  |Panchito  |Scirman          |pscirman1@kickstarter.com    |Male      |Junior Executive       |36.18 |2008-01-01|2008-01-01|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |3  |Chic      |Ickowics         |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-01|2008-01-01|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-02 00:00:00|D        |3  |Chic      |Ickowics         |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-01 00:00:00|I        |7  |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02 |2008-01-01|2008-01-03|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-04 00:00:00|D        |7  |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02 |2008-01-04|9999-12-31|1      |false |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|2008-01-01 00:00:00|I        |8  |Anstice   |Hollingdale      |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94 |2008-01-01|2008-01-02|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-03 00:00:00|U        |8  |Anstice   |Hollingdale Sauce|ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94 |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-03 00:00:00|D        |9  |Chaunce   |Holdforth        |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0  |2008-01-03|9999-12-31|1      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-01 00:00:00|I        |9  |Chaunce   |Holdforth        |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0  |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |10 |Blinni    |Fenty            |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98 |2008-01-01|2008-01-02|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-03 00:00:00|U        |11 |Tom       |Jerry            |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-02 00:00:00|I        |11 |Davidde   |Legier           |dlegier0@mail.ru             |Agender   |Editor                 |86.5  |2008-01-02|2008-01-02|3      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-02 00:00:00|I        |12 |Panchito  |Scirman          |pscirman1@kickstarter.com    |Male      |Junior Executive       |36.18 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-03 00:00:00|D        |13 |Chic      |Ickowics         |cickowics2@booking.com       |Male      |Research Associate     |100.0 |2008-01-03|9999-12-31|1      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-02 00:00:00|I        |13 |Chic      |Ickowics         |cickowics2@booking.com       |Male      |Research Associate     |35.54 |2008-01-02|2008-01-02|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-02 00:00:00|I        |14 |Pascale   |Jedrzaszkiewicz  |pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-02|2008-01-03|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-04 00:00:00|D        |14 |Pascale   |Jedrzaszkiewicz  |pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21 |2008-01-04|9999-12-31|1      |false |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
+-------------------+---------+---+----------+-----------------+-----------------------------+----------+-----------------------+------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
only showing top 20 rows

INFO : 2022-08-08 00:19:10,774 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(137) : Change Set for Current
+---+-------------------+---------+----------+-----------------+-----------------------------+-------+---------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name        |email                        |gender |job_title            |amount |from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+-----------------+-----------------------------+-------+---------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-03 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru             |Agender|Super Villain        |86.5   |2008-01-03|2008-01-02|3      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|1  |2008-01-04 00:00:00|U        |David     |Legier           |dlegier0@mail.ru             |Agender|Super Hero           |86.5   |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|1  |2008-01-02 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru             |Agender|Super Hero           |86.5   |2008-01-02|2008-01-02|4      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|1  |2008-01-03 00:00:00|U        |Davidde   |Legier           |dlegier0@mail.ru             |Agender|Super Villain        |86.5   |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|1  |2008-01-01 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru             |Agender|Editor               |86.5   |2008-01-01|2008-01-01|5      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|7  |2008-01-01 00:00:00|I        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male   |Chief Design Engineer|49.02  |2008-01-01|2008-01-03|2      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|7  |2008-01-04 00:00:00|D        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male   |Chief Design Engineer|49.02  |2008-01-04|9999-12-31|1      |false |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|7  |2008-01-01 00:00:00|I        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male   |Chief Design Engineer|49.02  |2008-01-01|2007-12-31|3      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|8  |2008-01-03 00:00:00|U        |Anstice   |Hollingdale Sauce|ahollingdale7@yahoo.co.jp    |Female |Cost Accountant      |21.94  |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|8  |2008-01-01 00:00:00|I        |Anstice   |Hollingdale      |ahollingdale7@yahoo.co.jp    |Female |Cost Accountant      |21.94  |2008-01-01|2008-01-02|4      |false |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|8  |2008-01-04 00:00:00|U        |Anstice   |Hollingdale      |ahollingdale7@yahoo.co.jp    |Female |Profit Accountant    |21.94  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|8  |2008-01-03 00:00:00|U        |Anstice   |Hollingdale Sauce|ahollingdale7@yahoo.co.jp    |Female |Cost Accountant      |21.94  |2008-01-03|2008-01-02|3      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|11 |2008-01-02 00:00:00|I        |Davidde   |Legier           |dlegier0@mail.ru             |Agender|Editor               |86.5   |2008-01-02|2008-01-02|4      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|11 |2008-01-03 00:00:00|U        |Tom       |Jerry            |dlegier0@mail.ru             |Agender|Editor               |86.5   |2008-01-03|2008-01-02|3      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|11 |2008-01-04 00:00:00|U        |Tom       |Jerry            |dlegier0@mail.ru             |Agender|PM of England        |10000.5|2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|11 |2008-01-03 00:00:00|U        |Tom       |Jerry            |dlegier0@mail.ru             |Agender|Editor               |86.5   |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|14 |2008-01-02 00:00:00|I        |Pascale   |Jedrzaszkiewicz  |pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV |73.21  |2008-01-02|2008-01-03|2      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|14 |2008-01-04 00:00:00|D        |Pascale   |Jedrzaszkiewicz  |pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV |73.21  |2008-01-04|9999-12-31|1      |false |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|14 |2008-01-02 00:00:00|I        |Pascale   |Jedrzaszkiewicz  |pjedrzaszkiewicz3@auda.org.au|Male   |Safety Technician IV |73.21  |2008-01-02|2008-01-01|3      |false |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|17 |2008-01-03 00:00:00|I        |Ingemar   |Petrus           |ipetrus6@blogspot.com        |Male   |Chief Design Engineer|49.02  |2008-01-03|2008-01-03|2      |false |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
+---+-------------------+---------+----------+-----------------+-----------------------------+-------+---------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
only showing top 20 rows

+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|id |extract_date       |load_flag|first_name|last_name      |email                        |gender    |job_title              |amount |from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|1  |2008-01-04 00:00:00|U        |David     |Legier         |dlegier0@mail.ru             |Agender   |Super Hero             |86.5   |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|7  |2008-01-04 00:00:00|D        |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02  |2008-01-04|9999-12-31|1      |false |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|8  |2008-01-04 00:00:00|U        |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Profit Accountant      |21.94  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|11 |2008-01-04 00:00:00|U        |Tom       |Jerry          |dlegier0@mail.ru             |Agender   |PM of England          |10000.5|2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|14 |2008-01-04 00:00:00|D        |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21  |2008-01-04|9999-12-31|1      |false |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|17 |2008-01-04 00:00:00|I        |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|18 |2008-01-04 00:00:00|I        |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|19 |2008-01-04 00:00:00|I        |Chaunce   |Holdforth      |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0   |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|20 |2008-01-04 00:00:00|I        |Blinni    |Fenty          |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
+---+-------------------+---------+----------+---------------+-----------------------------+----------+-----------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:19:34,310 : cdc_customer_landing_to_rawdb_csv : cdc_main.py.cdc_customer_landing_to_rawdb_csv: line(154) : Current
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|extract_date       |load_flag|id |first_name|last_name      |email                        |gender    |job_title              |amount |from_date |to_date   |version|active|_correlation_id                     |_load_timestamp           |_filename                                                                                      |
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+
|2008-01-04 00:00:00|U        |1  |David     |Legier         |dlegier0@mail.ru             |Agender   |Super Hero             |86.5   |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|2008-01-02 00:00:00|U        |2  |Panchito  |Scirman        |pscirman1@kickstarter.com    |Female    |Senior Executive       |36.18  |2008-01-02|9999-12-31|1      |true  |f228bf9e-21c3-403f-90aa-23a195b33481|2022-08-08 00:16:18.880907|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220802.csv|
|2008-01-03 00:00:00|I        |3  |Chic      |Ickowics       |wowiback@booking.com         |Male      |Research Associate     |35.54  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-01 00:00:00|I        |4  |Pascale   |Jedrzaszkiewicz|pjedrzaszkiewicz3@auda.org.au|Male      |Safety Technician IV   |73.21  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |5  |Sara      |Whiterod       |swhiterod4@hhs.gov           |Female    |Assistant Manager      |47.85  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-01 00:00:00|I        |6  |Mariska   |Antrum         |mantrum5@nytimes.com         |Female    |Tax Accountant         |16.37  |2008-01-01|9999-12-31|1      |true  |465e796a-682b-48e5-9fb2-5f2976595efd|2022-08-08 00:14:39.060813|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220801.csv|
|2008-01-04 00:00:00|U        |8  |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Profit Accountant      |21.94  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|2008-01-03 00:00:00|U        |10 |Blinni    |Blimey         |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-04 00:00:00|U        |11 |Tom       |Jerry          |dlegier0@mail.ru             |Agender   |PM of England          |10000.5|2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|2008-01-03 00:00:00|U        |12 |Panchito  |Scirman        |pscirman1@failedstarter.com  |Male      |Junior Executive       |36.18  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-03 00:00:00|I        |15 |Sara      |Whiterod       |swhiterod4@hhs.gov           |Female    |Assistant Manager      |47.85  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-03 00:00:00|I        |16 |Mariska   |Antrum         |mantrum5@nytimes.com         |Female    |Tax Accountant         |16.37  |2008-01-03|9999-12-31|1      |true  |cef08b6b-b9d5-45fd-806b-93564d131835|2022-08-08 00:17:53.204009|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220803.csv|
|2008-01-04 00:00:00|I        |17 |Ingemar   |Petrus         |ipetrus6@blogspot.com        |Male      |Chief Design Engineer  |49.02  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|2008-01-04 00:00:00|I        |18 |Anstice   |Hollingdale    |ahollingdale7@yahoo.co.jp    |Female    |Cost Accountant        |21.94  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|2008-01-04 00:00:00|I        |19 |Chaunce   |Holdforth      |choldforth8@ca.gov           |Non-binary|Chief Design Engineer  |72.0   |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
|2008-01-04 00:00:00|I        |20 |Blinni    |Fenty          |bfenty9@paginegialle.it      |Female    |Assistant Media Planner|38.98  |2008-01-04|9999-12-31|1      |true  |d47b02ee-e5d8-41f1-8fca-97c699fa9f37|2022-08-08 00:18:43.821456|file:///Users/shaunryan/AzureDevOps/yetl-patterns/data/landing/202208/cdc_customer_20220804.csv|
+-------------------+---------+---+----------+---------------+-----------------------------+----------+-----------------------+-------+----------+----------+-------+------+------------------------------------+--------------------------+-----------------------------------------------------------------------------------------------+

INFO : 2022-08-08 00:19:34,640 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audit: line(34) : Auditing database table raw.cdc_customer
INFO : 2022-08-08 00:19:34,904 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audit: line(34) : Auditing database table raw.cdc_customer_history
INFO : 2022-08-08 00:19:35,077 : cdc_customer_landing_to_rawdb_csv : _delta_lake.py.get_audits: line(48) : {
    "raw.cdc_customer": {
        "clusterId": null,
        "engineInfo": "Apache-Spark/3.2.1 Delta-Lake/2.0.0",
        "isBlindAppend": false,
        "isolationLevel": "Serializable",
        "job": null,
        "notebook": null,
        "operation": "MERGE",
        "operationMetrics": {
            "executionTimeMs": "12562",
            "numOutputRows": "7",
            "numSourceRows": "9",
            "numTargetChangeFilesAdded": "9",
            "numTargetFilesAdded": "7",
            "numTargetFilesRemoved": "6",
            "numTargetRowsCopied": "0",
            "numTargetRowsDeleted": "2",
            "numTargetRowsInserted": "3",
            "numTargetRowsUpdated": "4",
            "rewriteTimeMs": "11395",
            "scanTimeMs": "1163"
        },
        "operationParameters": {
            "matchedPredicates": "[{\"predicate\":\"((src.load_flag IN ('I', 'U')) AND (NOT (src.extract_date = dst.extract_date)))\",\"actionType\":\"update\"},{\"predicate\":\"(src.load_flag = 'D')\",\"actionType\":\"delete\"}]",
            "notMatchedPredicates": "[{\"predicate\":\"(src.load_flag IN ('I', 'U'))\",\"actionType\":\"insert\"}]",
            "predicate": "(dst.id = src.id)"
        },
        "readVersion": 23,
        "timestamp": "2022-08-08 00:19:26.383000",
        "userId": null,
        "userMetadata": null,
        "userName": null,
        "version": 24
    },
    "raw.cdc_customer_history": {
        "clusterId": null,
        "engineInfo": "Apache-Spark/3.2.1 Delta-Lake/2.0.0",
        "isBlindAppend": false,
        "isolationLevel": "Serializable",
        "job": null,
        "notebook": null,
        "operation": "MERGE",
        "operationMetrics": {
            "executionTimeMs": "2565",
            "numOutputRows": "21",
            "numSourceRows": "12",
            "numTargetChangeFilesAdded": "1",
            "numTargetFilesAdded": "1",
            "numTargetFilesRemoved": "1",
            "numTargetRowsCopied": "9",
            "numTargetRowsDeleted": "0",
            "numTargetRowsInserted": "8",
            "numTargetRowsUpdated": "4",
            "rewriteTimeMs": "1446",
            "scanTimeMs": "1115"
        },
        "operationParameters": {
            "matchedPredicates": "[{\"predicate\":\"(((NOT (dst.from_date = src.from_date)) OR (NOT (dst.to_date = src.to_date))) OR ((NOT (dst.version = src.version)) OR (NOT (dst.active = src.active))))\",\"actionType\":\"update\"}]",
            "notMatchedPredicates": "[{\"actionType\":\"insert\"}]",
            "predicate": "((dst.id = src.id) AND (dst.extract_date = src.extract_date))"
        },
        "readVersion": 23,
        "timestamp": "2022-08-08 00:19:02.355000",
        "userId": null,
        "userMetadata": null,
        "userName": null,
        "version": 24
    }
}
